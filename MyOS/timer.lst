     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_out8
     7 00000000                                 	EXTERN	_fifo8_put
     8 00000000                                 	EXTERN	_mm_free
     9 00000000                                 	EXTERN	_mtask_on
    10 00000000                                 	EXTERN	_task_switch
    11 00000000                                 	EXTERN	_mm_malloc
    12 00000000                                 	EXTERN	_io_load_eflags
    13 00000000                                 	EXTERN	_io_cli
    14 00000000                                 	EXTERN	_io_store_eflags
    15 00000000                                 [FILE "timer.c"]
    16                                          [SECTION .text]
    17 00000000                                 	GLOBAL	_init_pit
    18 00000000                                 _init_pit:
    19 00000000 55                              	PUSH	EBP
    20 00000001 89 E5                           	MOV	EBP,ESP
    21 00000003 6A 34                           	PUSH	52
    22 00000005 6A 43                           	PUSH	67
    23 00000007 E8 [00000000]                   	CALL	_io_out8
    24 0000000C 68 0000009C                     	PUSH	156
    25 00000011 6A 40                           	PUSH	64
    26 00000013 E8 [00000000]                   	CALL	_io_out8
    27 00000018 6A 2E                           	PUSH	46
    28 0000001A 6A 40                           	PUSH	64
    29 0000001C E8 [00000000]                   	CALL	_io_out8
    30 00000021 C7 05 0026A414 00000000         	MOV	DWORD [2532372],0
    31 0000002B C7 05 0026A418 00000000         	MOV	DWORD [2532376],0
    32 00000035 C7 05 [00000018] 00000000       	MOV	DWORD [_first],0
    33 0000003F C9                              	LEAVE
    34 00000040 C3                              	RET
    35 00000041                                 	GLOBAL	_inthandler20
    36 00000041                                 _inthandler20:
    37 00000041 55                              	PUSH	EBP
    38 00000042 89 E5                           	MOV	EBP,ESP
    39 00000044 6A 60                           	PUSH	96
    40 00000046 6A 20                           	PUSH	32
    41 00000048 E8 [00000000]                   	CALL	_io_out8
    42 0000004D A1 0026A418                     	MOV	EAX,DWORD [2532376]
    43 00000052 40                              	INC	EAX
    44 00000053 A3 0026A418                     	MOV	DWORD [2532376],EAX
    45 00000058 85 C0                           	TEST	EAX,EAX
    46 0000005A 59                              	POP	ECX
    47 0000005B 5A                              	POP	EDX
    48 0000005C 75 06                           	JNE	L3
    49 0000005E FF 05 0026A414                  	INC	DWORD [2532372]
    50 00000064                                 L3:
    51 00000064 83 3D [00000018] 00             	CMP	DWORD [_first],0
    52 0000006B 74 46                           	JE	L5
    53 0000006D                                 L6:
    54 0000006D A1 [00000018]                   	MOV	EAX,DWORD [_first]
    55 00000072 83 C0 04                        	ADD	EAX,4
    56 00000075 50                              	PUSH	EAX
    57 00000076 E8 00000088                     	CALL	_test_usr_timing
    58 0000007B 5A                              	POP	EDX
    59 0000007C 85 C0                           	TEST	EAX,EAX
    60 0000007E 74 33                           	JE	L5
    61 00000080 A1 [00000018]                   	MOV	EAX,DWORD [_first]
    62 00000085 0F B6 40 14                     	MOVZX	EAX,BYTE [20+EAX]
    63 00000089 50                              	PUSH	EAX
    64 0000008A 68 [00000000]                   	PUSH	_timerfifo
    65 0000008F E8 [00000000]                   	CALL	_fifo8_put
    66 00000094 8B 15 [00000018]                	MOV	EDX,DWORD [_first]
    67 0000009A 8B 02                           	MOV	EAX,DWORD [EDX]
    68 0000009C A3 [00000018]                   	MOV	DWORD [_first],EAX
    69 000000A1 52                              	PUSH	EDX
    70 000000A2 E8 [00000000]                   	CALL	_mm_free
    71 000000A7 83 C4 0C                        	ADD	ESP,12
    72 000000AA 83 3D [00000018] 00             	CMP	DWORD [_first],0
    73 000000B1 75 BA                           	JNE	L6
    74 000000B3                                 L5:
    75 000000B3 80 3D [00000000] 00             	CMP	BYTE [_mtask_on],0
    76 000000BA 75 02                           	JNE	L12
    77 000000BC C9                              	LEAVE
    78 000000BD C3                              	RET
    79 000000BE                                 L12:
    80 000000BE C9                              	LEAVE
    81 000000BF E9 [00000000]                   	JMP	_task_switch
    82 000000C4                                 	GLOBAL	_start_usr_timing
    83 000000C4                                 _start_usr_timing:
    84 000000C4 55                              	PUSH	EBP
    85 000000C5 89 E5                           	MOV	EBP,ESP
    86 000000C7 56                              	PUSH	ESI
    87 000000C8 53                              	PUSH	EBX
    88 000000C9 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
    89 000000CC A1 0026A414                     	MOV	EAX,DWORD [2532372]
    90 000000D1 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
    91 000000D4 89 01                           	MOV	DWORD [ECX],EAX
    92 000000D6 A1 0026A418                     	MOV	EAX,DWORD [2532376]
    93 000000DB 89 41 04                        	MOV	DWORD [4+ECX],EAX
    94 000000DE 8B 1D 0026A414                  	MOV	EBX,DWORD [2532372]
    95 000000E4 89 59 08                        	MOV	DWORD [8+ECX],EBX
    96 000000E7 A1 0026A418                     	MOV	EAX,DWORD [2532376]
    97 000000EC 89 41 0C                        	MOV	DWORD [12+ECX],EAX
    98 000000EF 8D 14 06                        	LEA	EDX,DWORD [ESI+EAX*1]
    99 000000F2 39 C2                           	CMP	EDX,EAX
   100 000000F4 73 06                           	JAE	L14
   101 000000F6 8D 43 01                        	LEA	EAX,DWORD [1+EBX]
   102 000000F9 89 41 08                        	MOV	DWORD [8+ECX],EAX
   103 000000FC                                 L14:
   104 000000FC 01 71 0C                        	ADD	DWORD [12+ECX],ESI
   105 000000FF 5B                              	POP	EBX
   106 00000100 5E                              	POP	ESI
   107 00000101 5D                              	POP	EBP
   108 00000102 C3                              	RET
   109 00000103                                 	GLOBAL	_test_usr_timing
   110 00000103                                 _test_usr_timing:
   111 00000103 55                              	PUSH	EBP
   112 00000104 89 E5                           	MOV	EBP,ESP
   113 00000106 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   114 00000109 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   115 0000010C 39 05 0026A414                  	CMP	DWORD [2532372],EAX
   116 00000112 72 12                           	JB	L16
   117 00000114 8B 42 0C                        	MOV	EAX,DWORD [12+EDX]
   118 00000117 39 05 0026A418                  	CMP	DWORD [2532376],EAX
   119 0000011D 72 07                           	JB	L16
   120 0000011F B8 00000001                     	MOV	EAX,1
   121 00000124                                 L15:
   122 00000124 5D                              	POP	EBP
   123 00000125 C3                              	RET
   124 00000126                                 L16:
   125 00000126 31 C0                           	XOR	EAX,EAX
   126 00000128 EB FA                           	JMP	L15
   127 0000012A                                 	GLOBAL	_start_timing
   128 0000012A                                 _start_timing:
   129 0000012A 55                              	PUSH	EBP
   130 0000012B 89 E5                           	MOV	EBP,ESP
   131 0000012D 57                              	PUSH	EDI
   132 0000012E 56                              	PUSH	ESI
   133 0000012F 53                              	PUSH	EBX
   134 00000130 51                              	PUSH	ECX
   135 00000131 51                              	PUSH	ECX
   136 00000132 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   137 00000135 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   138 00000138 6A 18                           	PUSH	24
   139 0000013A E8 [00000000]                   	CALL	_mm_malloc
   140 0000013F 8B 3D [00000018]                	MOV	EDI,DWORD [_first]
   141 00000145 C7 45 EC [00000018]             	MOV	DWORD [-20+EBP],_first
   142 0000014C 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   143 0000014F 88 58 14                        	MOV	BYTE [20+EAX],BL
   144 00000152 56                              	PUSH	ESI
   145 00000153 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   146 00000156 83 C0 04                        	ADD	EAX,4
   147 00000159 50                              	PUSH	EAX
   148 0000015A E8 FFFFFF65                     	CALL	_start_usr_timing
   149 0000015F E8 [00000000]                   	CALL	_io_load_eflags
   150 00000164 89 C3                           	MOV	EBX,EAX
   151 00000166 E8 [00000000]                   	CALL	_io_cli
   152 0000016B 83 C4 0C                        	ADD	ESP,12
   153 0000016E 85 FF                           	TEST	EDI,EDI
   154 00000170 74 1A                           	JE	L20
   155 00000172                                 L28:
   156 00000172 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   157 00000175 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   158 00000178 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   159 0000017B 39 C2                           	CMP	EDX,EAX
   160 0000017D 77 0D                           	JA	L20
   161 0000017F 39 C2                           	CMP	EDX,EAX
   162 00000181 74 22                           	JE	L30
   163 00000183                                 L24:
   164 00000183 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   165 00000186 8B 3F                           	MOV	EDI,DWORD [EDI]
   166 00000188 85 FF                           	TEST	EDI,EDI
   167 0000018A 75 E6                           	JNE	L28
   168 0000018C                                 L20:
   169 0000018C 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   170 0000018F 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   171 00000192 89 10                           	MOV	DWORD [EAX],EDX
   172 00000194 89 3A                           	MOV	DWORD [EDX],EDI
   173 00000196 89 5D 08                        	MOV	DWORD [8+EBP],EBX
   174 00000199 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   175 0000019C 5B                              	POP	EBX
   176 0000019D 5E                              	POP	ESI
   177 0000019E 5F                              	POP	EDI
   178 0000019F 5D                              	POP	EBP
   179 000001A0 E9 [00000000]                   	JMP	_io_store_eflags
   180 000001A5                                 L30:
   181 000001A5 8B 41 10                        	MOV	EAX,DWORD [16+ECX]
   182 000001A8 39 47 10                        	CMP	DWORD [16+EDI],EAX
   183 000001AB 76 D6                           	JBE	L24
   184 000001AD EB DD                           	JMP	L20
   185 000001AF                                 	GLOBAL	_timerfifo
   186                                          [SECTION .data]
   187 00000000                                 	ALIGNB	16
   188 00000000                                 _timerfifo:
   189 00000000 00 00 00 00 00 00 00 00 00 00   	RESB	24
       0000000A 00 00 00 00 00 00 00 00 00 00 
       00000014 00 00 00 00 
   190 00000018                                 	GLOBAL	_first
   191                                          [SECTION .data]
   192 00000018                                 	ALIGNB	4
   193 00000018                                 _first:
   194 00000018 00 00 00 00                     	RESB	4
