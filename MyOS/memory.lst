     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_load_eflags
     7 00000000                                 	EXTERN	_io_store_eflags
     8 00000000                                 	EXTERN	_memtest_sub
     9 00000000                                 	EXTERN	_load_cr0
    10 00000000                                 	EXTERN	_store_cr0
    11 00000000                                 [FILE "memory.c"]
    12                                          [SECTION .text]
    13 00000000                                 	GLOBAL	_memtest
    14 00000000                                 _memtest:
    15 00000000 55                              	PUSH	EBP
    16 00000001 89 E5                           	MOV	EBP,ESP
    17 00000003 56                              	PUSH	ESI
    18 00000004 53                              	PUSH	EBX
    19 00000005 31 F6                           	XOR	ESI,ESI
    20 00000007 E8 [00000000]                   	CALL	_io_load_eflags
    21 0000000C 0D 00040000                     	OR	EAX,262144
    22 00000011 50                              	PUSH	EAX
    23 00000012 E8 [00000000]                   	CALL	_io_store_eflags
    24 00000017 E8 [00000000]                   	CALL	_io_load_eflags
    25 0000001C 5A                              	POP	EDX
    26 0000001D A9 00040000                     	TEST	EAX,262144
    27 00000022 74 05                           	JE	L2
    28 00000024 BE 00000001                     	MOV	ESI,1
    29 00000029                                 L2:
    30 00000029 25 FFFBFFFF                     	AND	EAX,-262145
    31 0000002E 50                              	PUSH	EAX
    32 0000002F E8 [00000000]                   	CALL	_io_store_eflags
    33 00000034 58                              	POP	EAX
    34 00000035 89 F0                           	MOV	EAX,ESI
    35 00000037 84 C0                           	TEST	AL,AL
    36 00000039 75 31                           	JNE	L5
    37 0000003B                                 L3:
    38 0000003B FF 75 0C                        	PUSH	DWORD [12+EBP]
    39 0000003E FF 75 08                        	PUSH	DWORD [8+EBP]
    40 00000041 E8 [00000000]                   	CALL	_memtest_sub
    41 00000046 5A                              	POP	EDX
    42 00000047 89 C3                           	MOV	EBX,EAX
    43 00000049 59                              	POP	ECX
    44 0000004A 89 F0                           	MOV	EAX,ESI
    45 0000004C 84 C0                           	TEST	AL,AL
    46 0000004E 75 09                           	JNE	L6
    47 00000050                                 L4:
    48 00000050 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    49 00000053 89 D8                           	MOV	EAX,EBX
    50 00000055 5B                              	POP	EBX
    51 00000056 5E                              	POP	ESI
    52 00000057 5D                              	POP	EBP
    53 00000058 C3                              	RET
    54 00000059                                 L6:
    55 00000059 E8 [00000000]                   	CALL	_load_cr0
    56 0000005E 25 9FFFFFFF                     	AND	EAX,-1610612737
    57 00000063 50                              	PUSH	EAX
    58 00000064 E8 [00000000]                   	CALL	_store_cr0
    59 00000069 58                              	POP	EAX
    60 0000006A EB E4                           	JMP	L4
    61 0000006C                                 L5:
    62 0000006C E8 [00000000]                   	CALL	_load_cr0
    63 00000071 0D 60000000                     	OR	EAX,1610612736
    64 00000076 50                              	PUSH	EAX
    65 00000077 E8 [00000000]                   	CALL	_store_cr0
    66 0000007C 5B                              	POP	EBX
    67 0000007D EB BC                           	JMP	L3
    68                                          [SECTION .data]
    69 00000000                                 	ALIGNB	4
    70 00000000                                 _sbrk:
    71 00000000 00000000                        	DD	0
    72 00000004                                 	ALIGNB	4
    73 00000004                                 _end_memory:
    74 00000004 00000000                        	DD	0
    75                                          [SECTION .text]
    76 0000007F                                 	GLOBAL	_mm_check
    77 0000007F                                 _mm_check:
    78 0000007F 55                              	PUSH	EBP
    79 00000080 A1 [00000000]                   	MOV	EAX,DWORD [_sbrk]
    80 00000085 89 E5                           	MOV	EBP,ESP
    81 00000087 5D                              	POP	EBP
    82 00000088 C3                              	RET
    83 00000089                                 _mem_sbrk:
    84 00000089 55                              	PUSH	EBP
    85 0000008A 8B 0D [00000000]                	MOV	ECX,DWORD [_sbrk]
    86 00000090 89 E5                           	MOV	EBP,ESP
    87 00000092 89 CA                           	MOV	EDX,ECX
    88 00000094 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    89 00000097 83 E0 FC                        	AND	EAX,-4
    90 0000009A 01 C2                           	ADD	EDX,EAX
    91 0000009C 74 04                           	JE	L11
    92 0000009E 39 CA                           	CMP	EDX,ECX
    93 000000A0 72 0B                           	JB	L10
    94 000000A2                                 L11:
    95 000000A2 8D 42 FC                        	LEA	EAX,DWORD [-4+EDX]
    96 000000A5 3B 05 [00000004]                	CMP	EAX,DWORD [_end_memory]
    97 000000AB 76 04                           	JBE	L9
    98 000000AD                                 L10:
    99 000000AD 31 C0                           	XOR	EAX,EAX
   100 000000AF                                 L8:
   101 000000AF 5D                              	POP	EBP
   102 000000B0 C3                              	RET
   103 000000B1                                 L9:
   104 000000B1 89 15 [00000000]                	MOV	DWORD [_sbrk],EDX
   105 000000B7 89 C8                           	MOV	EAX,ECX
   106 000000B9 EB F4                           	JMP	L8
   107 000000BB                                 	GLOBAL	_mm_init
   108 000000BB                                 _mm_init:
   109 000000BB 55                              	PUSH	EBP
   110 000000BC 89 E5                           	MOV	EBP,ESP
   111 000000BE 6A 04                           	PUSH	4
   112 000000C0 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   113 000000C3 A3 [00000000]                   	MOV	DWORD [_sbrk],EAX
   114 000000C8 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   115 000000CB A3 [00000004]                   	MOV	DWORD [_end_memory],EAX
   116 000000D0 E8 FFFFFFB4                     	CALL	_mem_sbrk
   117 000000D5 A3 [00000008]                   	MOV	DWORD [_pro],EAX
   118 000000DA C7 00 FFFFFFFF                  	MOV	DWORD [EAX],-1
   119 000000E0 C7 05 [0000000C] 00000001       	MOV	DWORD [_last_prev],1
   120 000000EA C9                              	LEAVE
   121 000000EB C3                              	RET
   122 000000EC                                 	GLOBAL	_mm_malloc
   123 000000EC                                 _mm_malloc:
   124 000000EC 55                              	PUSH	EBP
   125 000000ED 8B 0D [00000008]                	MOV	ECX,DWORD [_pro]
   126 000000F3 89 E5                           	MOV	EBP,ESP
   127 000000F5 56                              	PUSH	ESI
   128 000000F6 53                              	PUSH	EBX
   129 000000F7 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   130 000000FA 83 39 FF                        	CMP	DWORD [ECX],-1
   131 000000FD 74 1F                           	JE	L31
   132 000000FF                                 L27:
   133 000000FF 8B 09                           	MOV	ECX,DWORD [ECX]
   134 00000101 8D 42 14                        	LEA	EAX,DWORD [20+EDX]
   135 00000104 8B 71 FC                        	MOV	ESI,DWORD [-4+ECX]
   136 00000107 83 E6 F8                        	AND	ESI,-8
   137 0000010A 39 C6                           	CMP	ESI,EAX
   138 0000010C 0F 83 00000095                  	JAE	L33
   139 00000112 8D 42 04                        	LEA	EAX,DWORD [4+EDX]
   140 00000115 39 C6                           	CMP	ESI,EAX
   141 00000117 73 4B                           	JAE	L34
   142 00000119 83 39 FF                        	CMP	DWORD [ECX],-1
   143 0000011C 75 E1                           	JNE	L27
   144 0000011E                                 L31:
   145 0000011E 8D 5A 0B                        	LEA	EBX,DWORD [11+EDX]
   146 00000121 83 E3 F8                        	AND	EBX,-8
   147 00000124 83 FB 10                        	CMP	EBX,16
   148 00000127 73 05                           	JAE	L28
   149 00000129 BB 00000010                     	MOV	EBX,16
   150 0000012E                                 L28:
   151 0000012E 53                              	PUSH	EBX
   152 0000012F E8 FFFFFF55                     	CALL	_mem_sbrk
   153 00000134 59                              	POP	ECX
   154 00000135 89 C2                           	MOV	EDX,EAX
   155 00000137 31 C0                           	XOR	EAX,EAX
   156 00000139 85 D2                           	TEST	EDX,EDX
   157 0000013B 74 20                           	JE	L14
   158 0000013D A1 [0000000C]                   	MOV	EAX,DWORD [_last_prev]
   159 00000142 01 C0                           	ADD	EAX,EAX
   160 00000144 09 C3                           	OR	EBX,EAX
   161 00000146 8D 42 04                        	LEA	EAX,DWORD [4+EDX]
   162 00000149 83 CB 01                        	OR	EBX,1
   163 0000014C A3 [00000010]                   	MOV	DWORD [_last_ptr],EAX
   164 00000151 89 1A                           	MOV	DWORD [EDX],EBX
   165 00000153 C7 05 [0000000C] 00000001       	MOV	DWORD [_last_prev],1
   166 0000015D                                 L14:
   167 0000015D 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   168 00000160 5B                              	POP	EBX
   169 00000161 5E                              	POP	ESI
   170 00000162 5D                              	POP	EBP
   171 00000163 C3                              	RET
   172 00000164                                 L34:
   173 00000164 39 0D [00000010]                	CMP	DWORD [_last_ptr],ECX
   174 0000016A 74 29                           	JE	L35
   175 0000016C                                 L24:
   176 0000016C 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   177 0000016F 8B 01                           	MOV	EAX,DWORD [ECX]
   178 00000171 89 02                           	MOV	DWORD [EDX],EAX
   179 00000173 8B 11                           	MOV	EDX,DWORD [ECX]
   180 00000175 83 FA FF                        	CMP	EDX,-1
   181 00000178 74 06                           	JE	L26
   182 0000017A 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   183 0000017D 89 42 04                        	MOV	DWORD [4+EDX],EAX
   184 00000180                                 L26:
   185 00000180 8B 41 FC                        	MOV	EAX,DWORD [-4+ECX]
   186 00000183 83 C8 03                        	OR	EAX,3
   187 00000186 89 41 FC                        	MOV	DWORD [-4+ECX],EAX
   188 00000189 83 E0 F8                        	AND	EAX,-8
   189 0000018C 83 4C 08 FC 02                  	OR	DWORD [-4+EAX+ECX*1],2
   190 00000191                                 L32:
   191 00000191 89 C8                           	MOV	EAX,ECX
   192 00000193 EB C8                           	JMP	L14
   193 00000195                                 L35:
   194 00000195 89 0D [00000010]                	MOV	DWORD [_last_ptr],ECX
   195 0000019B C7 05 [0000000C] 00000001       	MOV	DWORD [_last_prev],1
   196 000001A5 EB C5                           	JMP	L24
   197 000001A7                                 L33:
   198 000001A7 8D 42 0B                        	LEA	EAX,DWORD [11+EDX]
   199 000001AA 83 E0 F8                        	AND	EAX,-8
   200 000001AD 29 C6                           	SUB	ESI,EAX
   201 000001AF 89 C2                           	MOV	EDX,EAX
   202 000001B1 8D 1C 08                        	LEA	EBX,DWORD [EAX+ECX*1]
   203 000001B4 83 CA 03                        	OR	EDX,3
   204 000001B7 89 F0                           	MOV	EAX,ESI
   205 000001B9 89 51 FC                        	MOV	DWORD [-4+ECX],EDX
   206 000001BC 83 C8 02                        	OR	EAX,2
   207 000001BF 89 C2                           	MOV	EDX,EAX
   208 000001C1 89 43 FC                        	MOV	DWORD [-4+EBX],EAX
   209 000001C4 83 E2 F8                        	AND	EDX,-8
   210 000001C7 89 44 1A F8                     	MOV	DWORD [-8+EDX+EBX*1],EAX
   211 000001CB 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   212 000001CE 8B 11                           	MOV	EDX,DWORD [ECX]
   213 000001D0 83 FA FF                        	CMP	EDX,-1
   214 000001D3 89 18                           	MOV	DWORD [EAX],EBX
   215 000001D5 89 43 04                        	MOV	DWORD [4+EBX],EAX
   216 000001D8 89 13                           	MOV	DWORD [EBX],EDX
   217 000001DA 74 03                           	JE	L20
   218 000001DC 89 5A 04                        	MOV	DWORD [4+EDX],EBX
   219 000001DF                                 L20:
   220 000001DF 39 0D [00000010]                	CMP	DWORD [_last_ptr],ECX
   221 000001E5 75 AA                           	JNE	L32
   222 000001E7 89 1D [00000010]                	MOV	DWORD [_last_ptr],EBX
   223 000001ED EB A2                           	JMP	L32
   224 000001EF                                 	GLOBAL	_mm_free
   225 000001EF                                 _mm_free:
   226 000001EF 55                              	PUSH	EBP
   227 000001F0 89 E5                           	MOV	EBP,ESP
   228 000001F2 57                              	PUSH	EDI
   229 000001F3 56                              	PUSH	ESI
   230 000001F4 8B 3D [00000010]                	MOV	EDI,DWORD [_last_ptr]
   231 000001FA 53                              	PUSH	EBX
   232 000001FB 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   233 000001FE 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   234 00000201 89 C2                           	MOV	EDX,EAX
   235 00000203 83 E0 F8                        	AND	EAX,-8
   236 00000206 83 E2 02                        	AND	EDX,2
   237 00000209 D1 EA                           	SHR	EDX,1
   238 0000020B 8D 0C 18                        	LEA	ECX,DWORD [EAX+EBX*1]
   239 0000020E 39 FB                           	CMP	EBX,EDI
   240 00000210 B8 00000001                     	MOV	EAX,1
   241 00000215 8D 71 FC                        	LEA	ESI,DWORD [-4+ECX]
   242 00000218 74 06                           	JE	L38
   243 0000021A 8B 41 FC                        	MOV	EAX,DWORD [-4+ECX]
   244 0000021D 83 E0 01                        	AND	EAX,1
   245 00000220                                 L38:
   246 00000220 85 D2                           	TEST	EDX,EDX
   247 00000222 0F 84 000000B3                  	JE	L65
   248 00000228 85 C0                           	TEST	EAX,EAX
   249 0000022A 74 40                           	JE	L39
   250 0000022C 39 FB                           	CMP	EBX,EDI
   251 0000022E 74 2A                           	JE	L67
   252 00000230                                 L40:
   253 00000230 A1 [00000008]                   	MOV	EAX,DWORD [_pro]
   254 00000235 8B 10                           	MOV	EDX,DWORD [EAX]
   255 00000237 89 18                           	MOV	DWORD [EAX],EBX
   256 00000239 83 FA FF                        	CMP	EDX,-1
   257 0000023C 89 13                           	MOV	DWORD [EBX],EDX
   258 0000023E 89 43 04                        	MOV	DWORD [4+EBX],EAX
   259 00000241 74 03                           	JE	L42
   260 00000243 89 5A 04                        	MOV	DWORD [4+EDX],EBX
   261 00000246                                 L42:
   262 00000246 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   263 00000249 83 E0 FE                        	AND	EAX,-2
   264 0000024C 89 43 FC                        	MOV	DWORD [-4+EBX],EAX
   265 0000024F 89 46 FC                        	MOV	DWORD [-4+ESI],EAX
   266 00000252 83 26 FD                        	AND	DWORD [ESI],-3
   267 00000255                                 L36:
   268 00000255 5B                              	POP	EBX
   269 00000256 5E                              	POP	ESI
   270 00000257 5F                              	POP	EDI
   271 00000258 5D                              	POP	EBP
   272 00000259 C3                              	RET
   273 0000025A                                 L67:
   274 0000025A C7 05 [0000000C] 00000000       	MOV	DWORD [_last_prev],0
   275 00000264 89 1D [00000010]                	MOV	DWORD [_last_ptr],EBX
   276 0000026A EB C4                           	JMP	L40
   277 0000026C                                 L39:
   278 0000026C 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   279 0000026F 83 E0 F8                        	AND	EAX,-8
   280 00000272 8D 04 18                        	LEA	EAX,DWORD [EAX+EBX*1]
   281 00000275 39 F8                           	CMP	EAX,EDI
   282 00000277 74 50                           	JE	L68
   283 00000279                                 L54:
   284 00000279 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   285 0000027C 83 E0 F8                        	AND	EAX,-8
   286 0000027F 8D 0C 18                        	LEA	ECX,DWORD [EAX+EBX*1]
   287 00000282 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   288 00000285 8B 01                           	MOV	EAX,DWORD [ECX]
   289 00000287 89 02                           	MOV	DWORD [EDX],EAX
   290 00000289 8B 11                           	MOV	EDX,DWORD [ECX]
   291 0000028B 83 FA FF                        	CMP	EDX,-1
   292 0000028E 74 06                           	JE	L56
   293 00000290 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   294 00000293 89 42 04                        	MOV	DWORD [4+EDX],EAX
   295 00000296                                 L56:
   296 00000296 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   297 00000299 83 E0 F8                        	AND	EAX,-8
   298 0000029C 8D 0C 18                        	LEA	ECX,DWORD [EAX+EBX*1]
   299 0000029F 8B 51 FC                        	MOV	EDX,DWORD [-4+ECX]
   300 000002A2 83 E2 F8                        	AND	EDX,-8
   301 000002A5 01 D0                           	ADD	EAX,EDX
   302 000002A7 83 C8 02                        	OR	EAX,2
   303 000002AA 89 44 0A F8                     	MOV	DWORD [-8+EDX+ECX*1],EAX
   304 000002AE 89 43 FC                        	MOV	DWORD [-4+EBX],EAX
   305 000002B1 A1 [00000008]                   	MOV	EAX,DWORD [_pro]
   306 000002B6 8B 10                           	MOV	EDX,DWORD [EAX]
   307 000002B8 89 18                           	MOV	DWORD [EAX],EBX
   308 000002BA 83 FA FF                        	CMP	EDX,-1
   309 000002BD 89 13                           	MOV	DWORD [EBX],EDX
   310 000002BF 89 43 04                        	MOV	DWORD [4+EBX],EAX
   311 000002C2 74 91                           	JE	L36
   312 000002C4 89 5A 04                        	MOV	DWORD [4+EDX],EBX
   313 000002C7 EB 8C                           	JMP	L36
   314 000002C9                                 L68:
   315 000002C9 C7 05 [0000000C] 00000000       	MOV	DWORD [_last_prev],0
   316 000002D3 89 1D [00000010]                	MOV	DWORD [_last_ptr],EBX
   317 000002D9 EB 9E                           	JMP	L54
   318 000002DB                                 L65:
   319 000002DB 85 C0                           	TEST	EAX,EAX
   320 000002DD 0F 85 0000009B                  	JNE	L44
   321 000002E3 8B 43 F8                        	MOV	EAX,DWORD [-8+EBX]
   322 000002E6 89 DE                           	MOV	ESI,EBX
   323 000002E8 83 E0 FC                        	AND	EAX,-4
   324 000002EB 29 C6                           	SUB	ESI,EAX
   325 000002ED 8B 56 04                        	MOV	EDX,DWORD [4+ESI]
   326 000002F0 8B 06                           	MOV	EAX,DWORD [ESI]
   327 000002F2 89 02                           	MOV	DWORD [EDX],EAX
   328 000002F4 8B 16                           	MOV	EDX,DWORD [ESI]
   329 000002F6 83 FA FF                        	CMP	EDX,-1
   330 000002F9 74 06                           	JE	L46
   331 000002FB 8B 46 04                        	MOV	EAX,DWORD [4+ESI]
   332 000002FE 89 42 04                        	MOV	DWORD [4+EDX],EAX
   333 00000301                                 L46:
   334 00000301 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   335 00000304 83 E0 F8                        	AND	EAX,-8
   336 00000307 8D 04 18                        	LEA	EAX,DWORD [EAX+EBX*1]
   337 0000030A 39 F8                           	CMP	EAX,EDI
   338 0000030C 74 5E                           	JE	L69
   339 0000030E                                 L47:
   340 0000030E 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   341 00000311 83 E0 F8                        	AND	EAX,-8
   342 00000314 8D 0C 18                        	LEA	ECX,DWORD [EAX+EBX*1]
   343 00000317 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   344 0000031A 8B 01                           	MOV	EAX,DWORD [ECX]
   345 0000031C 89 02                           	MOV	DWORD [EDX],EAX
   346 0000031E 8B 11                           	MOV	EDX,DWORD [ECX]
   347 00000320 83 FA FF                        	CMP	EDX,-1
   348 00000323 74 06                           	JE	L49
   349 00000325 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   350 00000328 89 42 04                        	MOV	DWORD [4+EDX],EAX
   351 0000032B                                 L49:
   352 0000032B 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   353 0000032E 8B 56 FC                        	MOV	EDX,DWORD [-4+ESI]
   354 00000331 83 E0 F8                        	AND	EAX,-8
   355 00000334 83 E2 F8                        	AND	EDX,-8
   356 00000337 01 C3                           	ADD	EBX,EAX
   357 00000339 8B 4B FC                        	MOV	ECX,DWORD [-4+EBX]
   358 0000033C 83 E1 F8                        	AND	ECX,-8
   359 0000033F 01 C8                           	ADD	EAX,ECX
   360 00000341 01 D0                           	ADD	EAX,EDX
   361 00000343 83 C8 02                        	OR	EAX,2
   362 00000346 89 44 19 F8                     	MOV	DWORD [-8+ECX+EBX*1],EAX
   363 0000034A 89 46 FC                        	MOV	DWORD [-4+ESI],EAX
   364 0000034D A1 [00000008]                   	MOV	EAX,DWORD [_pro]
   365 00000352 8B 10                           	MOV	EDX,DWORD [EAX]
   366 00000354 89 30                           	MOV	DWORD [EAX],ESI
   367 00000356 83 FA FF                        	CMP	EDX,-1
   368 00000359 89 16                           	MOV	DWORD [ESI],EDX
   369 0000035B 89 46 04                        	MOV	DWORD [4+ESI],EAX
   370 0000035E 0F 84 FFFFFEF1                  	JE	L36
   371 00000364 89 72 04                        	MOV	DWORD [4+EDX],ESI
   372 00000367 E9 FFFFFEE9                     	JMP	L36
   373 0000036C                                 L69:
   374 0000036C C7 05 [0000000C] 00000000       	MOV	DWORD [_last_prev],0
   375 00000376 89 35 [00000010]                	MOV	DWORD [_last_ptr],ESI
   376 0000037C EB 90                           	JMP	L47
   377 0000037E                                 L44:
   378 0000037E 8B 43 F8                        	MOV	EAX,DWORD [-8+EBX]
   379 00000381 89 D9                           	MOV	ECX,EBX
   380 00000383 83 E0 FC                        	AND	EAX,-4
   381 00000386 29 C1                           	SUB	ECX,EAX
   382 00000388 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   383 0000038B 8B 01                           	MOV	EAX,DWORD [ECX]
   384 0000038D 89 02                           	MOV	DWORD [EDX],EAX
   385 0000038F 8B 11                           	MOV	EDX,DWORD [ECX]
   386 00000391 83 FA FF                        	CMP	EDX,-1
   387 00000394 74 06                           	JE	L61
   388 00000396 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   389 00000399 89 42 04                        	MOV	DWORD [4+EDX],EAX
   390 0000039C                                 L61:
   391 0000039C 39 FB                           	CMP	EBX,EDI
   392 0000039E 74 39                           	JE	L70
   393 000003A0                                 L62:
   394 000003A0 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   395 000003A3 8B 51 FC                        	MOV	EDX,DWORD [-4+ECX]
   396 000003A6 83 E2 F8                        	AND	EDX,-8
   397 000003A9 83 E0 F8                        	AND	EAX,-8
   398 000003AC 01 D0                           	ADD	EAX,EDX
   399 000003AE 83 C8 02                        	OR	EAX,2
   400 000003B1 89 41 FC                        	MOV	DWORD [-4+ECX],EAX
   401 000003B4 89 46 FC                        	MOV	DWORD [-4+ESI],EAX
   402 000003B7 A1 [00000008]                   	MOV	EAX,DWORD [_pro]
   403 000003BC 83 26 FD                        	AND	DWORD [ESI],-3
   404 000003BF 8B 10                           	MOV	EDX,DWORD [EAX]
   405 000003C1 89 08                           	MOV	DWORD [EAX],ECX
   406 000003C3 83 FA FF                        	CMP	EDX,-1
   407 000003C6 89 11                           	MOV	DWORD [ECX],EDX
   408 000003C8 89 41 04                        	MOV	DWORD [4+ECX],EAX
   409 000003CB 0F 84 FFFFFE84                  	JE	L36
   410 000003D1 89 4A 04                        	MOV	DWORD [4+EDX],ECX
   411 000003D4 E9 FFFFFE7C                     	JMP	L36
   412 000003D9                                 L70:
   413 000003D9 C7 05 [0000000C] 00000000       	MOV	DWORD [_last_prev],0
   414 000003E3 89 0D [00000010]                	MOV	DWORD [_last_ptr],ECX
   415 000003E9 EB B5                           	JMP	L62
   416 000003EB                                 	GLOBAL	_mm_realloc
   417 000003EB                                 _mm_realloc:
   418 000003EB 55                              	PUSH	EBP
   419 000003EC 89 E5                           	MOV	EBP,ESP
   420 000003EE 57                              	PUSH	EDI
   421 000003EF 56                              	PUSH	ESI
   422 000003F0 53                              	PUSH	EBX
   423 000003F1 83 EC 10                        	SUB	ESP,16
   424 000003F4 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   425 000003F7 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   426 000003FA 85 F6                           	TEST	ESI,ESI
   427 000003FC 0F 84 000000D3                  	JE	L87
   428 00000402 85 DB                           	TEST	EBX,EBX
   429 00000404 0F 84 000000C1                  	JE	L88
   430 0000040A 8B 46 FC                        	MOV	EAX,DWORD [-4+ESI]
   431 0000040D 83 E0 F8                        	AND	EAX,-8
   432 00000410 83 E8 04                        	SUB	EAX,4
   433 00000413 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   434 00000416 89 F0                           	MOV	EAX,ESI
   435 00000418 3B 5D F0                        	CMP	EBX,DWORD [-16+EBP]
   436 0000041B 76 67                           	JBE	L71
   437 0000041D 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   438 00000420 8D 3C 30                        	LEA	EDI,DWORD [EAX+ESI*1]
   439 00000423 8B 07                           	MOV	EAX,DWORD [EDI]
   440 00000425 89 C2                           	MOV	EDX,EAX
   441 00000427 83 E2 F8                        	AND	EDX,-8
   442 0000042A 89 55 EC                        	MOV	DWORD [-20+EBP],EDX
   443 0000042D 8B 15 [00000010]                	MOV	EDX,DWORD [_last_ptr]
   444 00000433 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   445 00000436 39 D6                           	CMP	ESI,EDX
   446 00000438 74 64                           	JE	L75
   447 0000043A 83 E0 01                        	AND	EAX,1
   448 0000043D 75 5F                           	JNE	L75
   449 0000043F 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   450 00000442 03 45 F0                        	ADD	EAX,DWORD [-16+EBP]
   451 00000445 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   452 00000448 39 D8                           	CMP	EAX,EBX
   453 0000044A 72 52                           	JB	L75
   454 0000044C 8D 4F 04                        	LEA	ECX,DWORD [4+EDI]
   455 0000044F 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   456 00000452 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   457 00000455 89 02                           	MOV	DWORD [EDX],EAX
   458 00000457 8B 57 04                        	MOV	EDX,DWORD [4+EDI]
   459 0000045A 83 FA FF                        	CMP	EDX,-1
   460 0000045D 74 06                           	JE	L77
   461 0000045F 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   462 00000462 89 42 04                        	MOV	DWORD [4+EDX],EAX
   463 00000465                                 L77:
   464 00000465 39 4D E8                        	CMP	DWORD [-24+EBP],ECX
   465 00000468 74 22                           	JE	L89
   466 0000046A                                 L78:
   467 0000046A 8B 46 FC                        	MOV	EAX,DWORD [-4+ESI]
   468 0000046D 8B 55 E4                        	MOV	EDX,DWORD [-28+EBP]
   469 00000470 83 C2 04                        	ADD	EDX,4
   470 00000473 83 E0 03                        	AND	EAX,3
   471 00000476 09 D0                           	OR	EAX,EDX
   472 00000478 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   473 0000047B 89 46 FC                        	MOV	DWORD [-4+ESI],EAX
   474 0000047E 89 F0                           	MOV	EAX,ESI
   475 00000480 83 0C 3A 02                     	OR	DWORD [EDX+EDI*1],2
   476 00000484                                 L71:
   477 00000484 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   478 00000487 5B                              	POP	EBX
   479 00000488 5E                              	POP	ESI
   480 00000489 5F                              	POP	EDI
   481 0000048A 5D                              	POP	EBP
   482 0000048B C3                              	RET
   483 0000048C                                 L89:
   484 0000048C 89 35 [00000010]                	MOV	DWORD [_last_ptr],ESI
   485 00000492 C7 05 [0000000C] 00000001       	MOV	DWORD [_last_prev],1
   486 0000049C EB CC                           	JMP	L78
   487 0000049E                                 L75:
   488 0000049E 53                              	PUSH	EBX
   489 0000049F E8 FFFFFC48                     	CALL	_mm_malloc
   490 000004A4 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   491 000004A7 89 C7                           	MOV	EDI,EAX
   492 000004A9 39 D9                           	CMP	ECX,EBX
   493 000004AB 58                              	POP	EAX
   494 000004AC 76 02                           	JBE	L79
   495 000004AE 89 D9                           	MOV	ECX,EBX
   496 000004B0                                 L79:
   497 000004B0 31 D2                           	XOR	EDX,EDX
   498 000004B2 39 CA                           	CMP	EDX,ECX
   499 000004B4 73 0B                           	JAE	L86
   500 000004B6                                 L84:
   501 000004B6 8A 04 32                        	MOV	AL,BYTE [EDX+ESI*1]
   502 000004B9 88 04 3A                        	MOV	BYTE [EDX+EDI*1],AL
   503 000004BC 42                              	INC	EDX
   504 000004BD 39 CA                           	CMP	EDX,ECX
   505 000004BF 72 F5                           	JB	L84
   506 000004C1                                 L86:
   507 000004C1 56                              	PUSH	ESI
   508 000004C2 E8 FFFFFD28                     	CALL	_mm_free
   509 000004C7 89 F8                           	MOV	EAX,EDI
   510 000004C9 EB B9                           	JMP	L71
   511 000004CB                                 L88:
   512 000004CB 56                              	PUSH	ESI
   513 000004CC E8 FFFFFD1E                     	CALL	_mm_free
   514 000004D1 31 C0                           	XOR	EAX,EAX
   515 000004D3 EB AF                           	JMP	L71
   516 000004D5                                 L87:
   517 000004D5 89 5D 08                        	MOV	DWORD [8+EBP],EBX
   518 000004D8 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   519 000004DB 5B                              	POP	EBX
   520 000004DC 5E                              	POP	ESI
   521 000004DD 5F                              	POP	EDI
   522 000004DE 5D                              	POP	EBP
   523 000004DF E9 FFFFFC08                     	JMP	_mm_malloc
   524 000004E4                                 	GLOBAL	_drop_chain
   525 000004E4                                 _drop_chain:
   526 000004E4 55                              	PUSH	EBP
   527 000004E5 89 E5                           	MOV	EBP,ESP
   528 000004E7 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   529 000004EA 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   530 000004ED 8B 01                           	MOV	EAX,DWORD [ECX]
   531 000004EF 89 02                           	MOV	DWORD [EDX],EAX
   532 000004F1 8B 11                           	MOV	EDX,DWORD [ECX]
   533 000004F3 83 FA FF                        	CMP	EDX,-1
   534 000004F6 74 06                           	JE	L90
   535 000004F8 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   536 000004FB 89 42 04                        	MOV	DWORD [4+EDX],EAX
   537 000004FE                                 L90:
   538 000004FE 5D                              	POP	EBP
   539 000004FF C3                              	RET
   540 00000500                                 	GLOBAL	_add_chain
   541 00000500                                 _add_chain:
   542 00000500 55                              	PUSH	EBP
   543 00000501 89 E5                           	MOV	EBP,ESP
   544 00000503 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   545 00000506 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   546 00000509 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   547 0000050C 89 10                           	MOV	DWORD [EAX],EDX
   548 0000050E 83 F9 FF                        	CMP	ECX,-1
   549 00000511 89 0A                           	MOV	DWORD [EDX],ECX
   550 00000513 89 42 04                        	MOV	DWORD [4+EDX],EAX
   551 00000516 74 03                           	JE	L92
   552 00000518 89 51 04                        	MOV	DWORD [4+ECX],EDX
   553 0000051B                                 L92:
   554 0000051B 5D                              	POP	EBP
   555 0000051C C3                              	RET
   556                                          [SECTION .data]
   557 00000008                                 	ALIGNB	4
   558 00000008                                 _pro:
   559 00000008 00 00 00 00                     	RESB	4
   560                                          [SECTION .data]
   561 0000000C                                 	ALIGNB	4
   562 0000000C                                 _last_prev:
   563 0000000C 00 00 00 00                     	RESB	4
   564                                          [SECTION .data]
   565 00000010                                 	ALIGNB	4
   566 00000010                                 _last_ptr:
   567 00000010 00 00 00 00                     	RESB	4
