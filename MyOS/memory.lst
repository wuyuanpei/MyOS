     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_load_eflags
     7 00000000                                 	EXTERN	_io_store_eflags
     8 00000000                                 	EXTERN	_memtest_sub
     9 00000000                                 	EXTERN	_load_cr0
    10 00000000                                 	EXTERN	_store_cr0
    11 00000000                                 [FILE "memory.c"]
    12                                          [SECTION .text]
    13 00000000                                 	GLOBAL	_memtest
    14 00000000                                 _memtest:
    15 00000000 55                              	PUSH	EBP
    16 00000001 89 E5                           	MOV	EBP,ESP
    17 00000003 56                              	PUSH	ESI
    18 00000004 53                              	PUSH	EBX
    19 00000005 31 F6                           	XOR	ESI,ESI
    20 00000007 E8 [00000000]                   	CALL	_io_load_eflags
    21 0000000C 0D 00040000                     	OR	EAX,262144
    22 00000011 50                              	PUSH	EAX
    23 00000012 E8 [00000000]                   	CALL	_io_store_eflags
    24 00000017 E8 [00000000]                   	CALL	_io_load_eflags
    25 0000001C 5A                              	POP	EDX
    26 0000001D A9 00040000                     	TEST	EAX,262144
    27 00000022 74 05                           	JE	L2
    28 00000024 BE 00000001                     	MOV	ESI,1
    29 00000029                                 L2:
    30 00000029 25 FFFBFFFF                     	AND	EAX,-262145
    31 0000002E 50                              	PUSH	EAX
    32 0000002F E8 [00000000]                   	CALL	_io_store_eflags
    33 00000034 58                              	POP	EAX
    34 00000035 89 F0                           	MOV	EAX,ESI
    35 00000037 84 C0                           	TEST	AL,AL
    36 00000039 75 31                           	JNE	L5
    37 0000003B                                 L3:
    38 0000003B FF 75 0C                        	PUSH	DWORD [12+EBP]
    39 0000003E FF 75 08                        	PUSH	DWORD [8+EBP]
    40 00000041 E8 [00000000]                   	CALL	_memtest_sub
    41 00000046 5A                              	POP	EDX
    42 00000047 89 C3                           	MOV	EBX,EAX
    43 00000049 59                              	POP	ECX
    44 0000004A 89 F0                           	MOV	EAX,ESI
    45 0000004C 84 C0                           	TEST	AL,AL
    46 0000004E 75 09                           	JNE	L6
    47 00000050                                 L4:
    48 00000050 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    49 00000053 89 D8                           	MOV	EAX,EBX
    50 00000055 5B                              	POP	EBX
    51 00000056 5E                              	POP	ESI
    52 00000057 5D                              	POP	EBP
    53 00000058 C3                              	RET
    54 00000059                                 L6:
    55 00000059 E8 [00000000]                   	CALL	_load_cr0
    56 0000005E 25 9FFFFFFF                     	AND	EAX,-1610612737
    57 00000063 50                              	PUSH	EAX
    58 00000064 E8 [00000000]                   	CALL	_store_cr0
    59 00000069 58                              	POP	EAX
    60 0000006A EB E4                           	JMP	L4
    61 0000006C                                 L5:
    62 0000006C E8 [00000000]                   	CALL	_load_cr0
    63 00000071 0D 60000000                     	OR	EAX,1610612736
    64 00000076 50                              	PUSH	EAX
    65 00000077 E8 [00000000]                   	CALL	_store_cr0
    66 0000007C 5B                              	POP	EBX
    67 0000007D EB BC                           	JMP	L3
    68                                          [SECTION .data]
    69 00000000                                 	ALIGNB	4
    70 00000000                                 _sbrk:
    71 00000000 00000000                        	DD	0
    72 00000004                                 	ALIGNB	4
    73 00000004                                 _end_memory:
    74 00000004 00000000                        	DD	0
    75                                          [SECTION .text]
    76 0000007F                                 	GLOBAL	_mm_total
    77 0000007F                                 _mm_total:
    78 0000007F 55                              	PUSH	EBP
    79 00000080 A1 [00000004]                   	MOV	EAX,DWORD [_end_memory]
    80 00000085 89 E5                           	MOV	EBP,ESP
    81 00000087 5D                              	POP	EBP
    82 00000088 C3                              	RET
    83 00000089                                 	GLOBAL	_mm_check
    84 00000089                                 _mm_check:
    85 00000089 8B 15 [00000008]                	MOV	EDX,DWORD [_pro]
    86 0000008F 55                              	PUSH	EBP
    87 00000090 8B 0D [00000004]                	MOV	ECX,DWORD [_end_memory]
    88 00000096 89 E5                           	MOV	EBP,ESP
    89 00000098 2B 0D [00000000]                	SUB	ECX,DWORD [_sbrk]
    90 0000009E 83 3A FF                        	CMP	DWORD [EDX],-1
    91 000000A1 74 0F                           	JE	L14
    92 000000A3                                 L12:
    93 000000A3 8B 12                           	MOV	EDX,DWORD [EDX]
    94 000000A5 8B 42 FC                        	MOV	EAX,DWORD [-4+EDX]
    95 000000A8 83 E0 F8                        	AND	EAX,-8
    96 000000AB 01 C1                           	ADD	ECX,EAX
    97 000000AD 83 3A FF                        	CMP	DWORD [EDX],-1
    98 000000B0 75 F1                           	JNE	L12
    99 000000B2                                 L14:
   100 000000B2 89 C8                           	MOV	EAX,ECX
   101 000000B4 5D                              	POP	EBP
   102 000000B5 C3                              	RET
   103 000000B6                                 	GLOBAL	_mm_sbrk
   104 000000B6                                 _mm_sbrk:
   105 000000B6 55                              	PUSH	EBP
   106 000000B7 A1 [00000000]                   	MOV	EAX,DWORD [_sbrk]
   107 000000BC 89 E5                           	MOV	EBP,ESP
   108 000000BE 5D                              	POP	EBP
   109 000000BF C3                              	RET
   110 000000C0                                 _mem_sbrk:
   111 000000C0 55                              	PUSH	EBP
   112 000000C1 8B 0D [00000000]                	MOV	ECX,DWORD [_sbrk]
   113 000000C7 89 E5                           	MOV	EBP,ESP
   114 000000C9 89 CA                           	MOV	EDX,ECX
   115 000000CB 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   116 000000CE 83 E0 FC                        	AND	EAX,-4
   117 000000D1 01 C2                           	ADD	EDX,EAX
   118 000000D3 74 04                           	JE	L19
   119 000000D5 39 CA                           	CMP	EDX,ECX
   120 000000D7 72 0B                           	JB	L18
   121 000000D9                                 L19:
   122 000000D9 8D 42 FC                        	LEA	EAX,DWORD [-4+EDX]
   123 000000DC 3B 05 [00000004]                	CMP	EAX,DWORD [_end_memory]
   124 000000E2 76 04                           	JBE	L17
   125 000000E4                                 L18:
   126 000000E4 31 C0                           	XOR	EAX,EAX
   127 000000E6                                 L16:
   128 000000E6 5D                              	POP	EBP
   129 000000E7 C3                              	RET
   130 000000E8                                 L17:
   131 000000E8 89 15 [00000000]                	MOV	DWORD [_sbrk],EDX
   132 000000EE 89 C8                           	MOV	EAX,ECX
   133 000000F0 EB F4                           	JMP	L16
   134 000000F2                                 	GLOBAL	_mm_init
   135 000000F2                                 _mm_init:
   136 000000F2 55                              	PUSH	EBP
   137 000000F3 89 E5                           	MOV	EBP,ESP
   138 000000F5 6A 04                           	PUSH	4
   139 000000F7 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   140 000000FA A3 [00000000]                   	MOV	DWORD [_sbrk],EAX
   141 000000FF 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   142 00000102 A3 [00000004]                   	MOV	DWORD [_end_memory],EAX
   143 00000107 E8 FFFFFFB4                     	CALL	_mem_sbrk
   144 0000010C A3 [00000008]                   	MOV	DWORD [_pro],EAX
   145 00000111 C7 00 FFFFFFFF                  	MOV	DWORD [EAX],-1
   146 00000117 C7 05 [0000000C] 00000001       	MOV	DWORD [_last_prev],1
   147 00000121 C9                              	LEAVE
   148 00000122 C3                              	RET
   149 00000123                                 	GLOBAL	_mm_malloc
   150 00000123                                 _mm_malloc:
   151 00000123 55                              	PUSH	EBP
   152 00000124 8B 0D [00000008]                	MOV	ECX,DWORD [_pro]
   153 0000012A 89 E5                           	MOV	EBP,ESP
   154 0000012C 56                              	PUSH	ESI
   155 0000012D 53                              	PUSH	EBX
   156 0000012E 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   157 00000131 83 39 FF                        	CMP	DWORD [ECX],-1
   158 00000134 74 1F                           	JE	L39
   159 00000136                                 L35:
   160 00000136 8B 09                           	MOV	ECX,DWORD [ECX]
   161 00000138 8D 42 14                        	LEA	EAX,DWORD [20+EDX]
   162 0000013B 8B 71 FC                        	MOV	ESI,DWORD [-4+ECX]
   163 0000013E 83 E6 F8                        	AND	ESI,-8
   164 00000141 39 C6                           	CMP	ESI,EAX
   165 00000143 0F 83 00000095                  	JAE	L41
   166 00000149 8D 42 04                        	LEA	EAX,DWORD [4+EDX]
   167 0000014C 39 C6                           	CMP	ESI,EAX
   168 0000014E 73 4B                           	JAE	L42
   169 00000150 83 39 FF                        	CMP	DWORD [ECX],-1
   170 00000153 75 E1                           	JNE	L35
   171 00000155                                 L39:
   172 00000155 8D 5A 0B                        	LEA	EBX,DWORD [11+EDX]
   173 00000158 83 E3 F8                        	AND	EBX,-8
   174 0000015B 83 FB 10                        	CMP	EBX,16
   175 0000015E 73 05                           	JAE	L36
   176 00000160 BB 00000010                     	MOV	EBX,16
   177 00000165                                 L36:
   178 00000165 53                              	PUSH	EBX
   179 00000166 E8 FFFFFF55                     	CALL	_mem_sbrk
   180 0000016B 59                              	POP	ECX
   181 0000016C 89 C2                           	MOV	EDX,EAX
   182 0000016E 31 C0                           	XOR	EAX,EAX
   183 00000170 85 D2                           	TEST	EDX,EDX
   184 00000172 74 20                           	JE	L22
   185 00000174 A1 [0000000C]                   	MOV	EAX,DWORD [_last_prev]
   186 00000179 01 C0                           	ADD	EAX,EAX
   187 0000017B 09 C3                           	OR	EBX,EAX
   188 0000017D 8D 42 04                        	LEA	EAX,DWORD [4+EDX]
   189 00000180 83 CB 01                        	OR	EBX,1
   190 00000183 A3 [00000010]                   	MOV	DWORD [_last_ptr],EAX
   191 00000188 89 1A                           	MOV	DWORD [EDX],EBX
   192 0000018A C7 05 [0000000C] 00000001       	MOV	DWORD [_last_prev],1
   193 00000194                                 L22:
   194 00000194 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   195 00000197 5B                              	POP	EBX
   196 00000198 5E                              	POP	ESI
   197 00000199 5D                              	POP	EBP
   198 0000019A C3                              	RET
   199 0000019B                                 L42:
   200 0000019B 39 0D [00000010]                	CMP	DWORD [_last_ptr],ECX
   201 000001A1 74 29                           	JE	L43
   202 000001A3                                 L32:
   203 000001A3 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   204 000001A6 8B 01                           	MOV	EAX,DWORD [ECX]
   205 000001A8 89 02                           	MOV	DWORD [EDX],EAX
   206 000001AA 8B 11                           	MOV	EDX,DWORD [ECX]
   207 000001AC 83 FA FF                        	CMP	EDX,-1
   208 000001AF 74 06                           	JE	L34
   209 000001B1 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   210 000001B4 89 42 04                        	MOV	DWORD [4+EDX],EAX
   211 000001B7                                 L34:
   212 000001B7 8B 41 FC                        	MOV	EAX,DWORD [-4+ECX]
   213 000001BA 83 C8 03                        	OR	EAX,3
   214 000001BD 89 41 FC                        	MOV	DWORD [-4+ECX],EAX
   215 000001C0 83 E0 F8                        	AND	EAX,-8
   216 000001C3 83 4C 08 FC 02                  	OR	DWORD [-4+EAX+ECX*1],2
   217 000001C8                                 L40:
   218 000001C8 89 C8                           	MOV	EAX,ECX
   219 000001CA EB C8                           	JMP	L22
   220 000001CC                                 L43:
   221 000001CC 89 0D [00000010]                	MOV	DWORD [_last_ptr],ECX
   222 000001D2 C7 05 [0000000C] 00000001       	MOV	DWORD [_last_prev],1
   223 000001DC EB C5                           	JMP	L32
   224 000001DE                                 L41:
   225 000001DE 8D 42 0B                        	LEA	EAX,DWORD [11+EDX]
   226 000001E1 83 E0 F8                        	AND	EAX,-8
   227 000001E4 29 C6                           	SUB	ESI,EAX
   228 000001E6 89 C2                           	MOV	EDX,EAX
   229 000001E8 8D 1C 08                        	LEA	EBX,DWORD [EAX+ECX*1]
   230 000001EB 83 CA 03                        	OR	EDX,3
   231 000001EE 89 F0                           	MOV	EAX,ESI
   232 000001F0 89 51 FC                        	MOV	DWORD [-4+ECX],EDX
   233 000001F3 83 C8 02                        	OR	EAX,2
   234 000001F6 89 C2                           	MOV	EDX,EAX
   235 000001F8 89 43 FC                        	MOV	DWORD [-4+EBX],EAX
   236 000001FB 83 E2 F8                        	AND	EDX,-8
   237 000001FE 89 44 1A F8                     	MOV	DWORD [-8+EDX+EBX*1],EAX
   238 00000202 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   239 00000205 8B 11                           	MOV	EDX,DWORD [ECX]
   240 00000207 83 FA FF                        	CMP	EDX,-1
   241 0000020A 89 18                           	MOV	DWORD [EAX],EBX
   242 0000020C 89 43 04                        	MOV	DWORD [4+EBX],EAX
   243 0000020F 89 13                           	MOV	DWORD [EBX],EDX
   244 00000211 74 03                           	JE	L28
   245 00000213 89 5A 04                        	MOV	DWORD [4+EDX],EBX
   246 00000216                                 L28:
   247 00000216 39 0D [00000010]                	CMP	DWORD [_last_ptr],ECX
   248 0000021C 75 AA                           	JNE	L40
   249 0000021E 89 1D [00000010]                	MOV	DWORD [_last_ptr],EBX
   250 00000224 EB A2                           	JMP	L40
   251 00000226                                 	GLOBAL	_mm_free
   252 00000226                                 _mm_free:
   253 00000226 55                              	PUSH	EBP
   254 00000227 89 E5                           	MOV	EBP,ESP
   255 00000229 57                              	PUSH	EDI
   256 0000022A 56                              	PUSH	ESI
   257 0000022B 8B 3D [00000010]                	MOV	EDI,DWORD [_last_ptr]
   258 00000231 53                              	PUSH	EBX
   259 00000232 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   260 00000235 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   261 00000238 89 C2                           	MOV	EDX,EAX
   262 0000023A 83 E0 F8                        	AND	EAX,-8
   263 0000023D 83 E2 02                        	AND	EDX,2
   264 00000240 D1 EA                           	SHR	EDX,1
   265 00000242 8D 0C 18                        	LEA	ECX,DWORD [EAX+EBX*1]
   266 00000245 39 FB                           	CMP	EBX,EDI
   267 00000247 B8 00000001                     	MOV	EAX,1
   268 0000024C 8D 71 FC                        	LEA	ESI,DWORD [-4+ECX]
   269 0000024F 74 06                           	JE	L46
   270 00000251 8B 41 FC                        	MOV	EAX,DWORD [-4+ECX]
   271 00000254 83 E0 01                        	AND	EAX,1
   272 00000257                                 L46:
   273 00000257 85 D2                           	TEST	EDX,EDX
   274 00000259 0F 84 000000B3                  	JE	L73
   275 0000025F 85 C0                           	TEST	EAX,EAX
   276 00000261 74 40                           	JE	L47
   277 00000263 39 FB                           	CMP	EBX,EDI
   278 00000265 74 2A                           	JE	L75
   279 00000267                                 L48:
   280 00000267 A1 [00000008]                   	MOV	EAX,DWORD [_pro]
   281 0000026C 8B 10                           	MOV	EDX,DWORD [EAX]
   282 0000026E 89 18                           	MOV	DWORD [EAX],EBX
   283 00000270 83 FA FF                        	CMP	EDX,-1
   284 00000273 89 13                           	MOV	DWORD [EBX],EDX
   285 00000275 89 43 04                        	MOV	DWORD [4+EBX],EAX
   286 00000278 74 03                           	JE	L50
   287 0000027A 89 5A 04                        	MOV	DWORD [4+EDX],EBX
   288 0000027D                                 L50:
   289 0000027D 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   290 00000280 83 E0 FE                        	AND	EAX,-2
   291 00000283 89 43 FC                        	MOV	DWORD [-4+EBX],EAX
   292 00000286 89 46 FC                        	MOV	DWORD [-4+ESI],EAX
   293 00000289 83 26 FD                        	AND	DWORD [ESI],-3
   294 0000028C                                 L44:
   295 0000028C 5B                              	POP	EBX
   296 0000028D 5E                              	POP	ESI
   297 0000028E 5F                              	POP	EDI
   298 0000028F 5D                              	POP	EBP
   299 00000290 C3                              	RET
   300 00000291                                 L75:
   301 00000291 C7 05 [0000000C] 00000000       	MOV	DWORD [_last_prev],0
   302 0000029B 89 1D [00000010]                	MOV	DWORD [_last_ptr],EBX
   303 000002A1 EB C4                           	JMP	L48
   304 000002A3                                 L47:
   305 000002A3 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   306 000002A6 83 E0 F8                        	AND	EAX,-8
   307 000002A9 8D 04 18                        	LEA	EAX,DWORD [EAX+EBX*1]
   308 000002AC 39 F8                           	CMP	EAX,EDI
   309 000002AE 74 50                           	JE	L76
   310 000002B0                                 L62:
   311 000002B0 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   312 000002B3 83 E0 F8                        	AND	EAX,-8
   313 000002B6 8D 0C 18                        	LEA	ECX,DWORD [EAX+EBX*1]
   314 000002B9 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   315 000002BC 8B 01                           	MOV	EAX,DWORD [ECX]
   316 000002BE 89 02                           	MOV	DWORD [EDX],EAX
   317 000002C0 8B 11                           	MOV	EDX,DWORD [ECX]
   318 000002C2 83 FA FF                        	CMP	EDX,-1
   319 000002C5 74 06                           	JE	L64
   320 000002C7 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   321 000002CA 89 42 04                        	MOV	DWORD [4+EDX],EAX
   322 000002CD                                 L64:
   323 000002CD 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   324 000002D0 83 E0 F8                        	AND	EAX,-8
   325 000002D3 8D 0C 18                        	LEA	ECX,DWORD [EAX+EBX*1]
   326 000002D6 8B 51 FC                        	MOV	EDX,DWORD [-4+ECX]
   327 000002D9 83 E2 F8                        	AND	EDX,-8
   328 000002DC 01 D0                           	ADD	EAX,EDX
   329 000002DE 83 C8 02                        	OR	EAX,2
   330 000002E1 89 44 0A F8                     	MOV	DWORD [-8+EDX+ECX*1],EAX
   331 000002E5 89 43 FC                        	MOV	DWORD [-4+EBX],EAX
   332 000002E8 A1 [00000008]                   	MOV	EAX,DWORD [_pro]
   333 000002ED 8B 10                           	MOV	EDX,DWORD [EAX]
   334 000002EF 89 18                           	MOV	DWORD [EAX],EBX
   335 000002F1 83 FA FF                        	CMP	EDX,-1
   336 000002F4 89 13                           	MOV	DWORD [EBX],EDX
   337 000002F6 89 43 04                        	MOV	DWORD [4+EBX],EAX
   338 000002F9 74 91                           	JE	L44
   339 000002FB 89 5A 04                        	MOV	DWORD [4+EDX],EBX
   340 000002FE EB 8C                           	JMP	L44
   341 00000300                                 L76:
   342 00000300 C7 05 [0000000C] 00000000       	MOV	DWORD [_last_prev],0
   343 0000030A 89 1D [00000010]                	MOV	DWORD [_last_ptr],EBX
   344 00000310 EB 9E                           	JMP	L62
   345 00000312                                 L73:
   346 00000312 85 C0                           	TEST	EAX,EAX
   347 00000314 0F 85 0000009B                  	JNE	L52
   348 0000031A 8B 43 F8                        	MOV	EAX,DWORD [-8+EBX]
   349 0000031D 89 DE                           	MOV	ESI,EBX
   350 0000031F 83 E0 FC                        	AND	EAX,-4
   351 00000322 29 C6                           	SUB	ESI,EAX
   352 00000324 8B 56 04                        	MOV	EDX,DWORD [4+ESI]
   353 00000327 8B 06                           	MOV	EAX,DWORD [ESI]
   354 00000329 89 02                           	MOV	DWORD [EDX],EAX
   355 0000032B 8B 16                           	MOV	EDX,DWORD [ESI]
   356 0000032D 83 FA FF                        	CMP	EDX,-1
   357 00000330 74 06                           	JE	L54
   358 00000332 8B 46 04                        	MOV	EAX,DWORD [4+ESI]
   359 00000335 89 42 04                        	MOV	DWORD [4+EDX],EAX
   360 00000338                                 L54:
   361 00000338 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   362 0000033B 83 E0 F8                        	AND	EAX,-8
   363 0000033E 8D 04 18                        	LEA	EAX,DWORD [EAX+EBX*1]
   364 00000341 39 F8                           	CMP	EAX,EDI
   365 00000343 74 5E                           	JE	L77
   366 00000345                                 L55:
   367 00000345 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   368 00000348 83 E0 F8                        	AND	EAX,-8
   369 0000034B 8D 0C 18                        	LEA	ECX,DWORD [EAX+EBX*1]
   370 0000034E 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   371 00000351 8B 01                           	MOV	EAX,DWORD [ECX]
   372 00000353 89 02                           	MOV	DWORD [EDX],EAX
   373 00000355 8B 11                           	MOV	EDX,DWORD [ECX]
   374 00000357 83 FA FF                        	CMP	EDX,-1
   375 0000035A 74 06                           	JE	L57
   376 0000035C 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   377 0000035F 89 42 04                        	MOV	DWORD [4+EDX],EAX
   378 00000362                                 L57:
   379 00000362 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   380 00000365 8B 56 FC                        	MOV	EDX,DWORD [-4+ESI]
   381 00000368 83 E0 F8                        	AND	EAX,-8
   382 0000036B 83 E2 F8                        	AND	EDX,-8
   383 0000036E 01 C3                           	ADD	EBX,EAX
   384 00000370 8B 4B FC                        	MOV	ECX,DWORD [-4+EBX]
   385 00000373 83 E1 F8                        	AND	ECX,-8
   386 00000376 01 C8                           	ADD	EAX,ECX
   387 00000378 01 D0                           	ADD	EAX,EDX
   388 0000037A 83 C8 02                        	OR	EAX,2
   389 0000037D 89 44 19 F8                     	MOV	DWORD [-8+ECX+EBX*1],EAX
   390 00000381 89 46 FC                        	MOV	DWORD [-4+ESI],EAX
   391 00000384 A1 [00000008]                   	MOV	EAX,DWORD [_pro]
   392 00000389 8B 10                           	MOV	EDX,DWORD [EAX]
   393 0000038B 89 30                           	MOV	DWORD [EAX],ESI
   394 0000038D 83 FA FF                        	CMP	EDX,-1
   395 00000390 89 16                           	MOV	DWORD [ESI],EDX
   396 00000392 89 46 04                        	MOV	DWORD [4+ESI],EAX
   397 00000395 0F 84 FFFFFEF1                  	JE	L44
   398 0000039B 89 72 04                        	MOV	DWORD [4+EDX],ESI
   399 0000039E E9 FFFFFEE9                     	JMP	L44
   400 000003A3                                 L77:
   401 000003A3 C7 05 [0000000C] 00000000       	MOV	DWORD [_last_prev],0
   402 000003AD 89 35 [00000010]                	MOV	DWORD [_last_ptr],ESI
   403 000003B3 EB 90                           	JMP	L55
   404 000003B5                                 L52:
   405 000003B5 8B 43 F8                        	MOV	EAX,DWORD [-8+EBX]
   406 000003B8 89 D9                           	MOV	ECX,EBX
   407 000003BA 83 E0 FC                        	AND	EAX,-4
   408 000003BD 29 C1                           	SUB	ECX,EAX
   409 000003BF 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   410 000003C2 8B 01                           	MOV	EAX,DWORD [ECX]
   411 000003C4 89 02                           	MOV	DWORD [EDX],EAX
   412 000003C6 8B 11                           	MOV	EDX,DWORD [ECX]
   413 000003C8 83 FA FF                        	CMP	EDX,-1
   414 000003CB 74 06                           	JE	L69
   415 000003CD 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   416 000003D0 89 42 04                        	MOV	DWORD [4+EDX],EAX
   417 000003D3                                 L69:
   418 000003D3 39 FB                           	CMP	EBX,EDI
   419 000003D5 74 39                           	JE	L78
   420 000003D7                                 L70:
   421 000003D7 8B 43 FC                        	MOV	EAX,DWORD [-4+EBX]
   422 000003DA 8B 51 FC                        	MOV	EDX,DWORD [-4+ECX]
   423 000003DD 83 E2 F8                        	AND	EDX,-8
   424 000003E0 83 E0 F8                        	AND	EAX,-8
   425 000003E3 01 D0                           	ADD	EAX,EDX
   426 000003E5 83 C8 02                        	OR	EAX,2
   427 000003E8 89 41 FC                        	MOV	DWORD [-4+ECX],EAX
   428 000003EB 89 46 FC                        	MOV	DWORD [-4+ESI],EAX
   429 000003EE A1 [00000008]                   	MOV	EAX,DWORD [_pro]
   430 000003F3 83 26 FD                        	AND	DWORD [ESI],-3
   431 000003F6 8B 10                           	MOV	EDX,DWORD [EAX]
   432 000003F8 89 08                           	MOV	DWORD [EAX],ECX
   433 000003FA 83 FA FF                        	CMP	EDX,-1
   434 000003FD 89 11                           	MOV	DWORD [ECX],EDX
   435 000003FF 89 41 04                        	MOV	DWORD [4+ECX],EAX
   436 00000402 0F 84 FFFFFE84                  	JE	L44
   437 00000408 89 4A 04                        	MOV	DWORD [4+EDX],ECX
   438 0000040B E9 FFFFFE7C                     	JMP	L44
   439 00000410                                 L78:
   440 00000410 C7 05 [0000000C] 00000000       	MOV	DWORD [_last_prev],0
   441 0000041A 89 0D [00000010]                	MOV	DWORD [_last_ptr],ECX
   442 00000420 EB B5                           	JMP	L70
   443 00000422                                 	GLOBAL	_mm_realloc
   444 00000422                                 _mm_realloc:
   445 00000422 55                              	PUSH	EBP
   446 00000423 89 E5                           	MOV	EBP,ESP
   447 00000425 57                              	PUSH	EDI
   448 00000426 56                              	PUSH	ESI
   449 00000427 53                              	PUSH	EBX
   450 00000428 83 EC 10                        	SUB	ESP,16
   451 0000042B 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   452 0000042E 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   453 00000431 85 F6                           	TEST	ESI,ESI
   454 00000433 0F 84 000000D3                  	JE	L95
   455 00000439 85 DB                           	TEST	EBX,EBX
   456 0000043B 0F 84 000000C1                  	JE	L96
   457 00000441 8B 46 FC                        	MOV	EAX,DWORD [-4+ESI]
   458 00000444 83 E0 F8                        	AND	EAX,-8
   459 00000447 83 E8 04                        	SUB	EAX,4
   460 0000044A 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   461 0000044D 89 F0                           	MOV	EAX,ESI
   462 0000044F 3B 5D F0                        	CMP	EBX,DWORD [-16+EBP]
   463 00000452 76 67                           	JBE	L79
   464 00000454 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   465 00000457 8D 3C 30                        	LEA	EDI,DWORD [EAX+ESI*1]
   466 0000045A 8B 07                           	MOV	EAX,DWORD [EDI]
   467 0000045C 89 C2                           	MOV	EDX,EAX
   468 0000045E 83 E2 F8                        	AND	EDX,-8
   469 00000461 89 55 EC                        	MOV	DWORD [-20+EBP],EDX
   470 00000464 8B 15 [00000010]                	MOV	EDX,DWORD [_last_ptr]
   471 0000046A 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   472 0000046D 39 D6                           	CMP	ESI,EDX
   473 0000046F 74 64                           	JE	L83
   474 00000471 83 E0 01                        	AND	EAX,1
   475 00000474 75 5F                           	JNE	L83
   476 00000476 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   477 00000479 03 45 F0                        	ADD	EAX,DWORD [-16+EBP]
   478 0000047C 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   479 0000047F 39 D8                           	CMP	EAX,EBX
   480 00000481 72 52                           	JB	L83
   481 00000483 8D 4F 04                        	LEA	ECX,DWORD [4+EDI]
   482 00000486 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   483 00000489 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   484 0000048C 89 02                           	MOV	DWORD [EDX],EAX
   485 0000048E 8B 57 04                        	MOV	EDX,DWORD [4+EDI]
   486 00000491 83 FA FF                        	CMP	EDX,-1
   487 00000494 74 06                           	JE	L85
   488 00000496 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   489 00000499 89 42 04                        	MOV	DWORD [4+EDX],EAX
   490 0000049C                                 L85:
   491 0000049C 39 4D E8                        	CMP	DWORD [-24+EBP],ECX
   492 0000049F 74 22                           	JE	L97
   493 000004A1                                 L86:
   494 000004A1 8B 46 FC                        	MOV	EAX,DWORD [-4+ESI]
   495 000004A4 8B 55 E4                        	MOV	EDX,DWORD [-28+EBP]
   496 000004A7 83 C2 04                        	ADD	EDX,4
   497 000004AA 83 E0 03                        	AND	EAX,3
   498 000004AD 09 D0                           	OR	EAX,EDX
   499 000004AF 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   500 000004B2 89 46 FC                        	MOV	DWORD [-4+ESI],EAX
   501 000004B5 89 F0                           	MOV	EAX,ESI
   502 000004B7 83 0C 3A 02                     	OR	DWORD [EDX+EDI*1],2
   503 000004BB                                 L79:
   504 000004BB 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   505 000004BE 5B                              	POP	EBX
   506 000004BF 5E                              	POP	ESI
   507 000004C0 5F                              	POP	EDI
   508 000004C1 5D                              	POP	EBP
   509 000004C2 C3                              	RET
   510 000004C3                                 L97:
   511 000004C3 89 35 [00000010]                	MOV	DWORD [_last_ptr],ESI
   512 000004C9 C7 05 [0000000C] 00000001       	MOV	DWORD [_last_prev],1
   513 000004D3 EB CC                           	JMP	L86
   514 000004D5                                 L83:
   515 000004D5 53                              	PUSH	EBX
   516 000004D6 E8 FFFFFC48                     	CALL	_mm_malloc
   517 000004DB 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   518 000004DE 89 C7                           	MOV	EDI,EAX
   519 000004E0 39 D9                           	CMP	ECX,EBX
   520 000004E2 58                              	POP	EAX
   521 000004E3 76 02                           	JBE	L87
   522 000004E5 89 D9                           	MOV	ECX,EBX
   523 000004E7                                 L87:
   524 000004E7 31 D2                           	XOR	EDX,EDX
   525 000004E9 39 CA                           	CMP	EDX,ECX
   526 000004EB 73 0B                           	JAE	L94
   527 000004ED                                 L92:
   528 000004ED 8A 04 32                        	MOV	AL,BYTE [EDX+ESI*1]
   529 000004F0 88 04 3A                        	MOV	BYTE [EDX+EDI*1],AL
   530 000004F3 42                              	INC	EDX
   531 000004F4 39 CA                           	CMP	EDX,ECX
   532 000004F6 72 F5                           	JB	L92
   533 000004F8                                 L94:
   534 000004F8 56                              	PUSH	ESI
   535 000004F9 E8 FFFFFD28                     	CALL	_mm_free
   536 000004FE 89 F8                           	MOV	EAX,EDI
   537 00000500 EB B9                           	JMP	L79
   538 00000502                                 L96:
   539 00000502 56                              	PUSH	ESI
   540 00000503 E8 FFFFFD1E                     	CALL	_mm_free
   541 00000508 31 C0                           	XOR	EAX,EAX
   542 0000050A EB AF                           	JMP	L79
   543 0000050C                                 L95:
   544 0000050C 89 5D 08                        	MOV	DWORD [8+EBP],EBX
   545 0000050F 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   546 00000512 5B                              	POP	EBX
   547 00000513 5E                              	POP	ESI
   548 00000514 5F                              	POP	EDI
   549 00000515 5D                              	POP	EBP
   550 00000516 E9 FFFFFC08                     	JMP	_mm_malloc
   551 0000051B                                 	GLOBAL	_drop_chain
   552 0000051B                                 _drop_chain:
   553 0000051B 55                              	PUSH	EBP
   554 0000051C 89 E5                           	MOV	EBP,ESP
   555 0000051E 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   556 00000521 8B 51 04                        	MOV	EDX,DWORD [4+ECX]
   557 00000524 8B 01                           	MOV	EAX,DWORD [ECX]
   558 00000526 89 02                           	MOV	DWORD [EDX],EAX
   559 00000528 8B 11                           	MOV	EDX,DWORD [ECX]
   560 0000052A 83 FA FF                        	CMP	EDX,-1
   561 0000052D 74 06                           	JE	L98
   562 0000052F 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   563 00000532 89 42 04                        	MOV	DWORD [4+EDX],EAX
   564 00000535                                 L98:
   565 00000535 5D                              	POP	EBP
   566 00000536 C3                              	RET
   567 00000537                                 	GLOBAL	_add_chain
   568 00000537                                 _add_chain:
   569 00000537 55                              	PUSH	EBP
   570 00000538 89 E5                           	MOV	EBP,ESP
   571 0000053A 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   572 0000053D 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   573 00000540 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   574 00000543 89 10                           	MOV	DWORD [EAX],EDX
   575 00000545 83 F9 FF                        	CMP	ECX,-1
   576 00000548 89 0A                           	MOV	DWORD [EDX],ECX
   577 0000054A 89 42 04                        	MOV	DWORD [4+EDX],EAX
   578 0000054D 74 03                           	JE	L100
   579 0000054F 89 51 04                        	MOV	DWORD [4+ECX],EDX
   580 00000552                                 L100:
   581 00000552 5D                              	POP	EBP
   582 00000553 C3                              	RET
   583                                          [SECTION .data]
   584 00000008                                 	ALIGNB	4
   585 00000008                                 _pro:
   586 00000008 00 00 00 00                     	RESB	4
   587                                          [SECTION .data]
   588 0000000C                                 	ALIGNB	4
   589 0000000C                                 _last_prev:
   590 0000000C 00 00 00 00                     	RESB	4
   591                                          [SECTION .data]
   592 00000010                                 	ALIGNB	4
   593 00000010                                 _last_ptr:
   594 00000010 00 00 00 00                     	RESB	4
