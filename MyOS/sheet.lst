     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_mm_malloc
     7 00000000                                 [FILE "sheet.c"]
     8                                          [SECTION .text]
     9 00000000                                 	GLOBAL	_shtctl_init
    10 00000000                                 _shtctl_init:
    11 00000000 55                              	PUSH	EBP
    12 00000001 89 E5                           	MOV	EBP,ESP
    13 00000003 56                              	PUSH	ESI
    14 00000004 53                              	PUSH	EBX
    15 00000005 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
    16 00000008 8B 75 10                        	MOV	ESI,DWORD [16+EBP]
    17 0000000B 89 D8                           	MOV	EAX,EBX
    18 0000000D 0F AF C6                        	IMUL	EAX,ESI
    19 00000010 50                              	PUSH	EAX
    20 00000011 E8 [00000000]                   	CALL	_mm_malloc
    21 00000016 BA 00268430                     	MOV	EDX,2524208
    22 0000001B A3 00268004                     	MOV	DWORD [2523140],EAX
    23 00000020 89 1D 00268008                  	MOV	DWORD [2523144],EBX
    24 00000026 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    25 00000029 89 35 0026800C                  	MOV	DWORD [2523148],ESI
    26 0000002F A3 00268000                     	MOV	DWORD [2523136],EAX
    27 00000034 C7 05 00268010 FFFFFFFF         	MOV	DWORD [2523152],-1
    28 0000003E 58                              	POP	EAX
    29 0000003F B8 000000FF                     	MOV	EAX,255
    30 00000044                                 L6:
    31 00000044 C7 02 00000000                  	MOV	DWORD [EDX],0
    32 0000004A 83 C2 20                        	ADD	EDX,32
    33 0000004D 48                              	DEC	EAX
    34 0000004E 79 F4                           	JNS	L6
    35 00000050 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    36 00000053 5B                              	POP	EBX
    37 00000054 5E                              	POP	ESI
    38 00000055 5D                              	POP	EBP
    39 00000056 C3                              	RET
    40 00000057                                 	GLOBAL	_sheet_alloc
    41 00000057                                 _sheet_alloc:
    42 00000057 55                              	PUSH	EBP
    43 00000058 31 D2                           	XOR	EDX,EDX
    44 0000005A 89 E5                           	MOV	EBP,ESP
    45 0000005C B8 00268414                     	MOV	EAX,2524180
    46 00000061                                 L15:
    47 00000061 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    48 00000065 74 10                           	JE	L18
    49 00000067 42                              	INC	EDX
    50 00000068 83 C0 20                        	ADD	EAX,32
    51 0000006B 81 FA 000000FF                  	CMP	EDX,255
    52 00000071 7E EE                           	JLE	L15
    53 00000073 31 C0                           	XOR	EAX,EAX
    54 00000075                                 L9:
    55 00000075 5D                              	POP	EBP
    56 00000076 C3                              	RET
    57 00000077                                 L18:
    58 00000077 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    59 0000007E C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    60 00000085 EB EE                           	JMP	L9
    61 00000087                                 	GLOBAL	_sheet_setbuf
    62 00000087                                 _sheet_setbuf:
    63 00000087 55                              	PUSH	EBP
    64 00000088 89 E5                           	MOV	EBP,ESP
    65 0000008A 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    66 0000008D 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    67 00000090 89 02                           	MOV	DWORD [EDX],EAX
    68 00000092 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    69 00000095 89 42 04                        	MOV	DWORD [4+EDX],EAX
    70 00000098 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    71 0000009B 89 42 08                        	MOV	DWORD [8+EDX],EAX
    72 0000009E 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
    73 000000A1 89 42 14                        	MOV	DWORD [20+EDX],EAX
    74 000000A4 5D                              	POP	EBP
    75 000000A5 C3                              	RET
    76 000000A6                                 _sheet_refreshmap:
    77 000000A6 55                              	PUSH	EBP
    78 000000A7 89 E5                           	MOV	EBP,ESP
    79 000000A9 57                              	PUSH	EDI
    80 000000AA 56                              	PUSH	ESI
    81 000000AB 53                              	PUSH	EBX
    82 000000AC 83 EC 34                        	SUB	ESP,52
    83 000000AF A1 00268004                     	MOV	EAX,DWORD [2523140]
    84 000000B4 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
    85 000000B7 83 7D 08 00                     	CMP	DWORD [8+EBP],0
    86 000000BB 0F 88 00000129                  	JS	L51
    87 000000C1                                 L21:
    88 000000C1 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
    89 000000C5 0F 88 00000113                  	JS	L52
    90 000000CB                                 L22:
    91 000000CB A1 00268008                     	MOV	EAX,DWORD [2523144]
    92 000000D0 39 45 10                        	CMP	DWORD [16+EBP],EAX
    93 000000D3 7E 03                           	JLE	L23
    94 000000D5 89 45 10                        	MOV	DWORD [16+EBP],EAX
    95 000000D8                                 L23:
    96 000000D8 A1 0026800C                     	MOV	EAX,DWORD [2523148]
    97 000000DD 39 45 14                        	CMP	DWORD [20+EBP],EAX
    98 000000E0 7E 03                           	JLE	L24
    99 000000E2 89 45 14                        	MOV	DWORD [20+EBP],EAX
   100 000000E5                                 L24:
   101 000000E5 8B 55 18                        	MOV	EDX,DWORD [24+EBP]
   102 000000E8 89 55 F0                        	MOV	DWORD [-16+EBP],EDX
   103 000000EB 3B 15 00268010                  	CMP	EDX,DWORD [2523152]
   104 000000F1 0F 8F 000000CC                  	JG	L46
   105 000000F7                                 L44:
   106 000000F7 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   107 000000FA 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   108 000000FD 8B 0C B5 00268014               	MOV	ECX,DWORD [2523156+ESI*4]
   109 00000104 8B 75 10                        	MOV	ESI,DWORD [16+EBP]
   110 00000107 8B 39                           	MOV	EDI,DWORD [ECX]
   111 00000109 8D 81 FFD97BEC                  	LEA	EAX,DWORD [-2524180+ECX]
   112 0000010F C1 E8 05                        	SHR	EAX,5
   113 00000112 8B 51 10                        	MOV	EDX,DWORD [16+ECX]
   114 00000115 89 7D E0                        	MOV	DWORD [-32+EBP],EDI
   115 00000118 29 D3                           	SUB	EBX,EDX
   116 0000011A 8B 7D 14                        	MOV	EDI,DWORD [20+EBP]
   117 0000011D 88 45 D0                        	MOV	BYTE [-48+EBP],AL
   118 00000120 29 D7                           	SUB	EDI,EDX
   119 00000122 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   120 00000125 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   121 00000128 29 C6                           	SUB	ESI,EAX
   122 0000012A 29 C2                           	SUB	EDX,EAX
   123 0000012C 89 75 C0                        	MOV	DWORD [-64+EBP],ESI
   124 0000012F 89 7D C8                        	MOV	DWORD [-56+EBP],EDI
   125 00000132 89 55 E4                        	MOV	DWORD [-28+EBP],EDX
   126 00000135 0F 88 00000097                  	JS	L53
   127 0000013B                                 L29:
   128 0000013B 85 DB                           	TEST	EBX,EBX
   129 0000013D 0F 88 00000088                  	JS	L54
   130 00000143                                 L30:
   131 00000143 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   132 00000146 39 45 C0                        	CMP	DWORD [-64+EBP],EAX
   133 00000149 7E 03                           	JLE	L31
   134 0000014B 89 45 C0                        	MOV	DWORD [-64+EBP],EAX
   135 0000014E                                 L31:
   136 0000014E 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   137 00000151 39 45 C8                        	CMP	DWORD [-56+EBP],EAX
   138 00000154 7E 03                           	JLE	L32
   139 00000156 89 45 C8                        	MOV	DWORD [-56+EBP],EAX
   140 00000159                                 L32:
   141 00000159 3B 5D C8                        	CMP	EBX,DWORD [-56+EBP]
   142 0000015C 7D 53                           	JGE	L48
   143 0000015E                                 L43:
   144 0000015E 8B 71 10                        	MOV	ESI,DWORD [16+ECX]
   145 00000161 8B 55 E4                        	MOV	EDX,DWORD [-28+EBP]
   146 00000164 01 DE                           	ADD	ESI,EBX
   147 00000166 3B 55 C0                        	CMP	EDX,DWORD [-64+EBP]
   148 00000169 89 75 E8                        	MOV	DWORD [-24+EBP],ESI
   149 0000016C 7D 3D                           	JGE	L50
   150 0000016E                                 L42:
   151 0000016E 89 D8                           	MOV	EAX,EBX
   152 00000170 8B 79 0C                        	MOV	EDI,DWORD [12+ECX]
   153 00000173 0F AF 41 04                     	IMUL	EAX,DWORD [4+ECX]
   154 00000177 01 D7                           	ADD	EDI,EDX
   155 00000179 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   156 0000017C 01 D0                           	ADD	EAX,EDX
   157 0000017E 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   158 00000181 0F B6 34 30                     	MOVZX	ESI,BYTE [EAX+ESI*1]
   159 00000185 3B 71 14                        	CMP	ESI,DWORD [20+ECX]
   160 00000188 74 1B                           	JE	L39
   161 0000018A 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   162 0000018D 8B 75 CC                        	MOV	ESI,DWORD [-52+EBP]
   163 00000190 0F AF 05 00268008               	IMUL	EAX,DWORD [2523144]
   164 00000197 01 F8                           	ADD	EAX,EDI
   165 00000199 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   166 0000019C 8A 45 D0                        	MOV	AL,BYTE [-48+EBP]
   167 0000019F 8B 7D C4                        	MOV	EDI,DWORD [-60+EBP]
   168 000001A2 88 04 37                        	MOV	BYTE [EDI+ESI*1],AL
   169 000001A5                                 L39:
   170 000001A5 42                              	INC	EDX
   171 000001A6 3B 55 C0                        	CMP	EDX,DWORD [-64+EBP]
   172 000001A9 7C C3                           	JL	L42
   173 000001AB                                 L50:
   174 000001AB 43                              	INC	EBX
   175 000001AC 3B 5D C8                        	CMP	EBX,DWORD [-56+EBP]
   176 000001AF 7C AD                           	JL	L43
   177 000001B1                                 L48:
   178 000001B1 FF 45 F0                        	INC	DWORD [-16+EBP]
   179 000001B4 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   180 000001B7 3B 05 00268010                  	CMP	EAX,DWORD [2523152]
   181 000001BD 0F 8E FFFFFF34                  	JLE	L44
   182 000001C3                                 L46:
   183 000001C3 83 C4 34                        	ADD	ESP,52
   184 000001C6 5B                              	POP	EBX
   185 000001C7 5E                              	POP	ESI
   186 000001C8 5F                              	POP	EDI
   187 000001C9 5D                              	POP	EBP
   188 000001CA C3                              	RET
   189 000001CB                                 L54:
   190 000001CB 31 DB                           	XOR	EBX,EBX
   191 000001CD E9 FFFFFF71                     	JMP	L30
   192 000001D2                                 L53:
   193 000001D2 C7 45 E4 00000000               	MOV	DWORD [-28+EBP],0
   194 000001D9 E9 FFFFFF5D                     	JMP	L29
   195 000001DE                                 L52:
   196 000001DE C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   197 000001E5 E9 FFFFFEE1                     	JMP	L22
   198 000001EA                                 L51:
   199 000001EA C7 45 08 00000000               	MOV	DWORD [8+EBP],0
   200 000001F1 E9 FFFFFECB                     	JMP	L21
   201 000001F6                                 _sheet_refreshsub:
   202 000001F6 55                              	PUSH	EBP
   203 000001F7 89 E5                           	MOV	EBP,ESP
   204 000001F9 57                              	PUSH	EDI
   205 000001FA 56                              	PUSH	ESI
   206 000001FB 53                              	PUSH	EBX
   207 000001FC 83 EC 34                        	SUB	ESP,52
   208 000001FF A1 00268000                     	MOV	EAX,DWORD [2523136]
   209 00000204 8B 15 00268004                  	MOV	EDX,DWORD [2523140]
   210 0000020A 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   211 0000020D 89 55 D8                        	MOV	DWORD [-40+EBP],EDX
   212 00000210 83 7D 08 00                     	CMP	DWORD [8+EBP],0
   213 00000214 0F 88 00000128                  	JS	L86
   214 0000021A                                 L56:
   215 0000021A 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   216 0000021E 0F 88 00000112                  	JS	L87
   217 00000224                                 L57:
   218 00000224 A1 00268008                     	MOV	EAX,DWORD [2523144]
   219 00000229 39 45 10                        	CMP	DWORD [16+EBP],EAX
   220 0000022C 7E 03                           	JLE	L58
   221 0000022E 89 45 10                        	MOV	DWORD [16+EBP],EAX
   222 00000231                                 L58:
   223 00000231 A1 0026800C                     	MOV	EAX,DWORD [2523148]
   224 00000236 39 45 14                        	CMP	DWORD [20+EBP],EAX
   225 00000239 7E 03                           	JLE	L59
   226 0000023B 89 45 14                        	MOV	DWORD [20+EBP],EAX
   227 0000023E                                 L59:
   228 0000023E 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   229 00000241 8B 7D 1C                        	MOV	EDI,DWORD [28+EBP]
   230 00000244 89 75 F0                        	MOV	DWORD [-16+EBP],ESI
   231 00000247 39 FE                           	CMP	ESI,EDI
   232 00000249 0F 8F 000000B3                  	JG	L81
   233 0000024F                                 L79:
   234 0000024F 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   235 00000252 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
   236 00000255 8B 7D 14                        	MOV	EDI,DWORD [20+EBP]
   237 00000258 8B 75 10                        	MOV	ESI,DWORD [16+EBP]
   238 0000025B 8B 1C 85 00268014               	MOV	EBX,DWORD [2523156+EAX*4]
   239 00000262 8B 13                           	MOV	EDX,DWORD [EBX]
   240 00000264 8D 83 FFD97BEC                  	LEA	EAX,DWORD [-2524180+EBX]
   241 0000026A C1 E8 05                        	SHR	EAX,5
   242 0000026D 89 55 E0                        	MOV	DWORD [-32+EBP],EDX
   243 00000270 8B 53 10                        	MOV	EDX,DWORD [16+EBX]
   244 00000273 88 45 C8                        	MOV	BYTE [-56+EBP],AL
   245 00000276 29 D7                           	SUB	EDI,EDX
   246 00000278 29 D1                           	SUB	ECX,EDX
   247 0000027A 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   248 0000027D 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   249 00000280 29 C6                           	SUB	ESI,EAX
   250 00000282 89 7D C0                        	MOV	DWORD [-64+EBP],EDI
   251 00000285 29 C2                           	SUB	EDX,EAX
   252 00000287 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   253 0000028A 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   254 0000028D 0F 88 00000097                  	JS	L88
   255 00000293                                 L64:
   256 00000293 85 C9                           	TEST	ECX,ECX
   257 00000295 0F 88 00000088                  	JS	L89
   258 0000029B                                 L65:
   259 0000029B 8B 43 04                        	MOV	EAX,DWORD [4+EBX]
   260 0000029E 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   261 000002A1 7E 03                           	JLE	L66
   262 000002A3 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   263 000002A6                                 L66:
   264 000002A6 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   265 000002A9 39 45 C0                        	CMP	DWORD [-64+EBP],EAX
   266 000002AC 7E 03                           	JLE	L67
   267 000002AE 89 45 C0                        	MOV	DWORD [-64+EBP],EAX
   268 000002B1                                 L67:
   269 000002B1 89 CE                           	MOV	ESI,ECX
   270 000002B3 3B 4D C0                        	CMP	ECX,DWORD [-64+EBP]
   271 000002B6 7D 3B                           	JGE	L83
   272 000002B8                                 L78:
   273 000002B8 8B 7B 10                        	MOV	EDI,DWORD [16+EBX]
   274 000002BB 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   275 000002BE 01 F7                           	ADD	EDI,ESI
   276 000002C0 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   277 000002C3 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   278 000002C6 7D 25                           	JGE	L85
   279 000002C8                                 L77:
   280 000002C8 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   281 000002CB 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   282 000002CE 0F AF 05 00268008               	IMUL	EAX,DWORD [2523144]
   283 000002D5 01 CA                           	ADD	EDX,ECX
   284 000002D7 8B 7D D8                        	MOV	EDI,DWORD [-40+EBP]
   285 000002DA 01 D0                           	ADD	EAX,EDX
   286 000002DC 8A 55 C8                        	MOV	DL,BYTE [-56+EBP]
   287 000002DF 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   288 000002E2 38 14 38                        	CMP	BYTE [EAX+EDI*1],DL
   289 000002E5 74 23                           	JE	L90
   290 000002E7                                 L74:
   291 000002E7 41                              	INC	ECX
   292 000002E8 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   293 000002EB 7C DB                           	JL	L77
   294 000002ED                                 L85:
   295 000002ED 46                              	INC	ESI
   296 000002EE 3B 75 C0                        	CMP	ESI,DWORD [-64+EBP]
   297 000002F1 7C C5                           	JL	L78
   298 000002F3                                 L83:
   299 000002F3 8B 75 1C                        	MOV	ESI,DWORD [28+EBP]
   300 000002F6 FF 45 F0                        	INC	DWORD [-16+EBP]
   301 000002F9 39 75 F0                        	CMP	DWORD [-16+EBP],ESI
   302 000002FC 0F 8E FFFFFF4D                  	JLE	L79
   303 00000302                                 L81:
   304 00000302 83 C4 34                        	ADD	ESP,52
   305 00000305 5B                              	POP	EBX
   306 00000306 5E                              	POP	ESI
   307 00000307 5F                              	POP	EDI
   308 00000308 5D                              	POP	EBP
   309 00000309 C3                              	RET
   310 0000030A                                 L90:
   311 0000030A 89 F0                           	MOV	EAX,ESI
   312 0000030C 8B 55 E0                        	MOV	EDX,DWORD [-32+EBP]
   313 0000030F 0F AF 43 04                     	IMUL	EAX,DWORD [4+EBX]
   314 00000313 01 C8                           	ADD	EAX,ECX
   315 00000315 8B 7D DC                        	MOV	EDI,DWORD [-36+EBP]
   316 00000318 8A 04 10                        	MOV	AL,BYTE [EAX+EDX*1]
   317 0000031B 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   318 0000031E 88 04 3A                        	MOV	BYTE [EDX+EDI*1],AL
   319 00000321 EB C4                           	JMP	L74
   320 00000323                                 L89:
   321 00000323 31 C9                           	XOR	ECX,ECX
   322 00000325 E9 FFFFFF71                     	JMP	L65
   323 0000032A                                 L88:
   324 0000032A C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   325 00000331 E9 FFFFFF5D                     	JMP	L64
   326 00000336                                 L87:
   327 00000336 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   328 0000033D E9 FFFFFEE2                     	JMP	L57
   329 00000342                                 L86:
   330 00000342 C7 45 08 00000000               	MOV	DWORD [8+EBP],0
   331 00000349 E9 FFFFFECC                     	JMP	L56
   332 0000034E                                 	GLOBAL	_sheet_updown
   333 0000034E                                 _sheet_updown:
   334 0000034E 55                              	PUSH	EBP
   335 0000034F 89 E5                           	MOV	EBP,ESP
   336 00000351 57                              	PUSH	EDI
   337 00000352 56                              	PUSH	ESI
   338 00000353 53                              	PUSH	EBX
   339 00000354 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   340 00000357 A1 00268010                     	MOV	EAX,DWORD [2523152]
   341 0000035C 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   342 0000035F 40                              	INC	EAX
   343 00000360 8B 7E 18                        	MOV	EDI,DWORD [24+ESI]
   344 00000363 39 C3                           	CMP	EBX,EAX
   345 00000365 7E 02                           	JLE	L92
   346 00000367 89 C3                           	MOV	EBX,EAX
   347 00000369                                 L92:
   348 00000369 83 FB FF                        	CMP	EBX,-1
   349 0000036C 7D 03                           	JGE	L93
   350 0000036E 83 CB FF                        	OR	EBX,-1
   351 00000371                                 L93:
   352 00000371 89 5E 18                        	MOV	DWORD [24+ESI],EBX
   353 00000374 39 DF                           	CMP	EDI,EBX
   354 00000376 0F 8E 000000B6                  	JLE	L94
   355 0000037C 85 DB                           	TEST	EBX,EBX
   356 0000037E 78 60                           	JS	L95
   357 00000380 89 F9                           	MOV	ECX,EDI
   358 00000382                                 L100:
   359 00000382 8B 04 8D 00268010               	MOV	EAX,DWORD [2523152+ECX*4]
   360 00000389 89 04 8D 00268014               	MOV	DWORD [2523156+ECX*4],EAX
   361 00000390 89 48 18                        	MOV	DWORD [24+EAX],ECX
   362 00000393 49                              	DEC	ECX
   363 00000394 39 D9                           	CMP	ECX,EBX
   364 00000396 7F EA                           	JG	L100
   365 00000398 89 34 9D 00268014               	MOV	DWORD [2523156+EBX*4],ESI
   366 0000039F 43                              	INC	EBX
   367 000003A0 53                              	PUSH	EBX
   368 000003A1 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   369 000003A4 89 C8                           	MOV	EAX,ECX
   370 000003A6 03 46 08                        	ADD	EAX,DWORD [8+ESI]
   371 000003A9 50                              	PUSH	EAX
   372 000003AA 8B 56 0C                        	MOV	EDX,DWORD [12+ESI]
   373 000003AD 89 D0                           	MOV	EAX,EDX
   374 000003AF 03 46 04                        	ADD	EAX,DWORD [4+ESI]
   375 000003B2 50                              	PUSH	EAX
   376 000003B3 51                              	PUSH	ECX
   377 000003B4 52                              	PUSH	EDX
   378 000003B5 E8 FFFFFCEC                     	CALL	_sheet_refreshmap
   379 000003BA 57                              	PUSH	EDI
   380 000003BB                                 L130:
   381 000003BB 53                              	PUSH	EBX
   382 000003BC                                 L129:
   383 000003BC 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   384 000003BF 89 C8                           	MOV	EAX,ECX
   385 000003C1 03 46 08                        	ADD	EAX,DWORD [8+ESI]
   386 000003C4 50                              	PUSH	EAX
   387 000003C5 8B 56 0C                        	MOV	EDX,DWORD [12+ESI]
   388 000003C8 89 D0                           	MOV	EAX,EDX
   389 000003CA 03 46 04                        	ADD	EAX,DWORD [4+ESI]
   390 000003CD 50                              	PUSH	EAX
   391 000003CE 51                              	PUSH	ECX
   392 000003CF 52                              	PUSH	EDX
   393 000003D0 E8 FFFFFE21                     	CALL	_sheet_refreshsub
   394 000003D5 83 C4 2C                        	ADD	ESP,44
   395 000003D8                                 L91:
   396 000003D8 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   397 000003DB 5B                              	POP	EBX
   398 000003DC 5E                              	POP	ESI
   399 000003DD 5F                              	POP	EDI
   400 000003DE 5D                              	POP	EBP
   401 000003DF C3                              	RET
   402 000003E0                                 L95:
   403 000003E0 A1 00268010                     	MOV	EAX,DWORD [2523152]
   404 000003E5 39 F8                           	CMP	EAX,EDI
   405 000003E7 7E 20                           	JLE	L102
   406 000003E9 89 F9                           	MOV	ECX,EDI
   407 000003EB 39 C7                           	CMP	EDI,EAX
   408 000003ED 7D 1A                           	JGE	L102
   409 000003EF                                 L107:
   410 000003EF 8B 04 8D 00268018               	MOV	EAX,DWORD [2523160+ECX*4]
   411 000003F6 89 04 8D 00268014               	MOV	DWORD [2523156+ECX*4],EAX
   412 000003FD 89 48 18                        	MOV	DWORD [24+EAX],ECX
   413 00000400 41                              	INC	ECX
   414 00000401 3B 0D 00268010                  	CMP	ECX,DWORD [2523152]
   415 00000407 7C E6                           	JL	L107
   416 00000409                                 L102:
   417 00000409 FF 0D 00268010                  	DEC	DWORD [2523152]
   418 0000040F 6A 00                           	PUSH	0
   419 00000411 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   420 00000414 89 C8                           	MOV	EAX,ECX
   421 00000416 03 46 08                        	ADD	EAX,DWORD [8+ESI]
   422 00000419 50                              	PUSH	EAX
   423 0000041A 8B 56 0C                        	MOV	EDX,DWORD [12+ESI]
   424 0000041D 89 D0                           	MOV	EAX,EDX
   425 0000041F 03 46 04                        	ADD	EAX,DWORD [4+ESI]
   426 00000422 50                              	PUSH	EAX
   427 00000423 51                              	PUSH	ECX
   428 00000424 52                              	PUSH	EDX
   429 00000425 E8 FFFFFC7C                     	CALL	_sheet_refreshmap
   430 0000042A 8D 47 FF                        	LEA	EAX,DWORD [-1+EDI]
   431 0000042D 50                              	PUSH	EAX
   432 0000042E 6A 00                           	PUSH	0
   433 00000430 EB 8A                           	JMP	L129
   434 00000432                                 L94:
   435 00000432 39 DF                           	CMP	EDI,EBX
   436 00000434 7D A2                           	JGE	L91
   437 00000436 85 FF                           	TEST	EDI,EDI
   438 00000438 78 43                           	JS	L110
   439 0000043A 89 F9                           	MOV	ECX,EDI
   440 0000043C 39 DF                           	CMP	EDI,EBX
   441 0000043E 7D 16                           	JGE	L126
   442 00000440                                 L115:
   443 00000440 8B 04 8D 00268018               	MOV	EAX,DWORD [2523160+ECX*4]
   444 00000447 89 04 8D 00268014               	MOV	DWORD [2523156+ECX*4],EAX
   445 0000044E 89 48 18                        	MOV	DWORD [24+EAX],ECX
   446 00000451 41                              	INC	ECX
   447 00000452 39 D9                           	CMP	ECX,EBX
   448 00000454 7C EA                           	JL	L115
   449 00000456                                 L126:
   450 00000456 89 34 9D 00268014               	MOV	DWORD [2523156+EBX*4],ESI
   451 0000045D                                 L116:
   452 0000045D 53                              	PUSH	EBX
   453 0000045E 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   454 00000461 89 C8                           	MOV	EAX,ECX
   455 00000463 03 46 08                        	ADD	EAX,DWORD [8+ESI]
   456 00000466 50                              	PUSH	EAX
   457 00000467 8B 56 0C                        	MOV	EDX,DWORD [12+ESI]
   458 0000046A 89 D0                           	MOV	EAX,EDX
   459 0000046C 03 46 04                        	ADD	EAX,DWORD [4+ESI]
   460 0000046F 50                              	PUSH	EAX
   461 00000470 51                              	PUSH	ECX
   462 00000471 52                              	PUSH	EDX
   463 00000472 E8 FFFFFC2F                     	CALL	_sheet_refreshmap
   464 00000477 53                              	PUSH	EBX
   465 00000478 E9 FFFFFF3E                     	JMP	L130
   466 0000047D                                 L110:
   467 0000047D 8B 0D 00268010                  	MOV	ECX,DWORD [2523152]
   468 00000483 39 D9                           	CMP	ECX,EBX
   469 00000485 7C 19                           	JL	L128
   470 00000487                                 L121:
   471 00000487 8B 14 8D 00268014               	MOV	EDX,DWORD [2523156+ECX*4]
   472 0000048E 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   473 00000491 89 14 8D 00268018               	MOV	DWORD [2523160+ECX*4],EDX
   474 00000498 49                              	DEC	ECX
   475 00000499 89 42 18                        	MOV	DWORD [24+EDX],EAX
   476 0000049C 39 D9                           	CMP	ECX,EBX
   477 0000049E 7D E7                           	JGE	L121
   478 000004A0                                 L128:
   479 000004A0 89 34 9D 00268014               	MOV	DWORD [2523156+EBX*4],ESI
   480 000004A7 FF 05 00268010                  	INC	DWORD [2523152]
   481 000004AD EB AE                           	JMP	L116
   482 000004AF                                 	GLOBAL	_sheet_refresh
   483 000004AF                                 _sheet_refresh:
   484 000004AF 55                              	PUSH	EBP
   485 000004B0 89 E5                           	MOV	EBP,ESP
   486 000004B2 57                              	PUSH	EDI
   487 000004B3 56                              	PUSH	ESI
   488 000004B4 53                              	PUSH	EBX
   489 000004B5 52                              	PUSH	EDX
   490 000004B6 52                              	PUSH	EDX
   491 000004B7 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   492 000004BA 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   493 000004BD 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   494 000004C0 8B 7D 14                        	MOV	EDI,DWORD [20+EBP]
   495 000004C3 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   496 000004C6 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   497 000004C9 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   498 000004CC 8B 55 1C                        	MOV	EDX,DWORD [28+EBP]
   499 000004CF 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   500 000004D2 85 C0                           	TEST	EAX,EAX
   501 000004D4 78 63                           	JS	L131
   502 000004D6 85 D2                           	TEST	EDX,EDX
   503 000004D8 74 57                           	JE	L133
   504 000004DA 6A 00                           	PUSH	0
   505 000004DC 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   506 000004DF 8D 04 0E                        	LEA	EAX,DWORD [ESI+ECX*1]
   507 000004E2 50                              	PUSH	EAX
   508 000004E3 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   509 000004E6 8D 04 17                        	LEA	EAX,DWORD [EDI+EDX*1]
   510 000004E9 50                              	PUSH	EAX
   511 000004EA 03 4D EC                        	ADD	ECX,DWORD [-20+EBP]
   512 000004ED 51                              	PUSH	ECX
   513 000004EE 03 55 F0                        	ADD	EDX,DWORD [-16+EBP]
   514 000004F1 52                              	PUSH	EDX
   515 000004F2 E8 FFFFFBAF                     	CALL	_sheet_refreshmap
   516 000004F7 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   517 000004FA 83 C4 14                        	ADD	ESP,20
   518 000004FD 89 45 1C                        	MOV	DWORD [28+EBP],EAX
   519 00000500 C7 45 18 00000000               	MOV	DWORD [24+EBP],0
   520 00000507                                 L135:
   521 00000507 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   522 0000050A 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   523 0000050D 8D 04 0E                        	LEA	EAX,DWORD [ESI+ECX*1]
   524 00000510 03 4D EC                        	ADD	ECX,DWORD [-20+EBP]
   525 00000513 89 45 14                        	MOV	DWORD [20+EBP],EAX
   526 00000516 8D 04 17                        	LEA	EAX,DWORD [EDI+EDX*1]
   527 00000519 89 4D 0C                        	MOV	DWORD [12+EBP],ECX
   528 0000051C 03 55 F0                        	ADD	EDX,DWORD [-16+EBP]
   529 0000051F 89 45 10                        	MOV	DWORD [16+EBP],EAX
   530 00000522 89 55 08                        	MOV	DWORD [8+EBP],EDX
   531 00000525 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   532 00000528 5B                              	POP	EBX
   533 00000529 5E                              	POP	ESI
   534 0000052A 5F                              	POP	EDI
   535 0000052B 5D                              	POP	EBP
   536 0000052C E9 FFFFFCC5                     	JMP	_sheet_refreshsub
   537 00000531                                 L133:
   538 00000531 89 45 1C                        	MOV	DWORD [28+EBP],EAX
   539 00000534 89 45 18                        	MOV	DWORD [24+EBP],EAX
   540 00000537 EB CE                           	JMP	L135
   541 00000539                                 L131:
   542 00000539 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   543 0000053C 5B                              	POP	EBX
   544 0000053D 5E                              	POP	ESI
   545 0000053E 5F                              	POP	EDI
   546 0000053F 5D                              	POP	EBP
   547 00000540 C3                              	RET
   548 00000541                                 	GLOBAL	_sheet_slide
   549 00000541                                 _sheet_slide:
   550 00000541 55                              	PUSH	EBP
   551 00000542 89 E5                           	MOV	EBP,ESP
   552 00000544 57                              	PUSH	EDI
   553 00000545 56                              	PUSH	ESI
   554 00000546 53                              	PUSH	EBX
   555 00000547 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   556 0000054A 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   557 0000054D 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   558 00000550 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   559 00000553 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   560 00000556 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   561 00000559 89 43 10                        	MOV	DWORD [16+EBX],EAX
   562 0000055C 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   563 00000560 78 70                           	JS	L136
   564 00000562 6A 00                           	PUSH	0
   565 00000564 89 F0                           	MOV	EAX,ESI
   566 00000566 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   567 00000569 50                              	PUSH	EAX
   568 0000056A 89 F8                           	MOV	EAX,EDI
   569 0000056C 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   570 0000056F 50                              	PUSH	EAX
   571 00000570 56                              	PUSH	ESI
   572 00000571 57                              	PUSH	EDI
   573 00000572 E8 FFFFFB2F                     	CALL	_sheet_refreshmap
   574 00000577 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   575 0000057A FF 73 18                        	PUSH	DWORD [24+EBX]
   576 0000057D 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   577 00000580 50                              	PUSH	EAX
   578 00000581 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   579 00000584 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   580 00000587 50                              	PUSH	EAX
   581 00000588 FF 75 10                        	PUSH	DWORD [16+EBP]
   582 0000058B FF 75 0C                        	PUSH	DWORD [12+EBP]
   583 0000058E E8 FFFFFB13                     	CALL	_sheet_refreshmap
   584 00000593 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   585 00000596 83 C4 28                        	ADD	ESP,40
   586 00000599 48                              	DEC	EAX
   587 0000059A 50                              	PUSH	EAX
   588 0000059B 89 F0                           	MOV	EAX,ESI
   589 0000059D 6A 00                           	PUSH	0
   590 0000059F 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   591 000005A2 50                              	PUSH	EAX
   592 000005A3 89 F8                           	MOV	EAX,EDI
   593 000005A5 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   594 000005A8 50                              	PUSH	EAX
   595 000005A9 56                              	PUSH	ESI
   596 000005AA 57                              	PUSH	EDI
   597 000005AB E8 FFFFFC46                     	CALL	_sheet_refreshsub
   598 000005B0 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   599 000005B3 FF 73 18                        	PUSH	DWORD [24+EBX]
   600 000005B6 FF 73 18                        	PUSH	DWORD [24+EBX]
   601 000005B9 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   602 000005BC 50                              	PUSH	EAX
   603 000005BD 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   604 000005C0 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   605 000005C3 50                              	PUSH	EAX
   606 000005C4 FF 75 10                        	PUSH	DWORD [16+EBP]
   607 000005C7 FF 75 0C                        	PUSH	DWORD [12+EBP]
   608 000005CA E8 FFFFFC27                     	CALL	_sheet_refreshsub
   609 000005CF 83 C4 30                        	ADD	ESP,48
   610 000005D2                                 L136:
   611 000005D2 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   612 000005D5 5B                              	POP	EBX
   613 000005D6 5E                              	POP	ESI
   614 000005D7 5F                              	POP	EDI
   615 000005D8 5D                              	POP	EBP
   616 000005D9 C3                              	RET
   617 000005DA                                 	GLOBAL	_sheet_free
   618 000005DA                                 _sheet_free:
   619 000005DA 55                              	PUSH	EBP
   620 000005DB 89 E5                           	MOV	EBP,ESP
   621 000005DD 53                              	PUSH	EBX
   622 000005DE 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   623 000005E1 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   624 000005E5 78 0A                           	JS	L139
   625 000005E7 6A FF                           	PUSH	-1
   626 000005E9 53                              	PUSH	EBX
   627 000005EA E8 FFFFFD5F                     	CALL	_sheet_updown
   628 000005EF 59                              	POP	ECX
   629 000005F0 58                              	POP	EAX
   630 000005F1                                 L139:
   631 000005F1 C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   632 000005F8 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   633 000005FB C9                              	LEAVE
   634 000005FC C3                              	RET
